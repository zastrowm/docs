
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
      <meta name="description" content="Documentation for Strands Agents, a simple-to-use, code-first, lightweight library for building AI agents">
    
    
    
      <link rel="canonical" href="https://strandsagents.com/latest/api-reference/tools/">
    
    
      <link rel="prev" href="../telemetry/">
    
    
      <link rel="next" href="../types/">
    
    
    <link rel="icon" href="../../assets/logo-light.png" sizes="any">
    <link rel="icon" href="../../assets/logo-auto.svg" type="image/svg+xml">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">

    
      
        <title>Tools - Strands Agents SDK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#strands.tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Strands Agents SDK" class="md-header__button md-logo" aria-label="Strands Agents SDK" data-md-component="logo">
      <!-- Logo -->

  <img src="../../assets/logo-light.svg" alt="logo" class="logo-light" />
  <img src="../../assets/logo-dark.svg" alt="logo" class="logo-dark" />

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Strands Agents SDK
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tools
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/strands-agents/sdk-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/strands-agents/sdk-python/blob/main/CONTRIBUTING.md" class="md-tabs__link">
        
  
  
    
  
  Contribute ❤️

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../agent/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Strands Agents SDK" class="md-nav__button md-logo" aria-label="Strands Agents SDK" data-md-component="logo">
      <!-- Logo -->

  <img src="../../assets/logo-light.svg" alt="logo" class="logo-light" />
  <img src="../../assets/logo-dark.svg" alt="logo" class="logo-dark" />

    </a>
    Strands Agents SDK
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/strands-agents/sdk-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3_1" >
        
          
          <label class="md-nav__link" for="__nav_1_3_1" id="__nav_1_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/agents/agent-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent Loop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/agents/sessions-state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sessions & State
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/agents/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/agents/context-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3_2" >
        
          
          <label class="md-nav__link" for="__nav_1_3_2" id="__nav_1_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/tools/tools_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/tools/python-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/tools/mcp-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Context Protocol (MCP)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/tools/example-tools-package/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Tools Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3_3" id="__nav_1_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Providers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            Model Providers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/amazon-bedrock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon Bedrock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/anthropic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anthropic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/litellm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LiteLLM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/llamaapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LlamaAPI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ollama
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/openai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/model-providers/custom_model_provider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Providers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3_4" >
        
          
          <label class="md-nav__link" for="__nav_1_3_4" id="__nav_1_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3_4">
            <span class="md-nav__icon md-icon"></span>
            Streaming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/streaming/async-iterators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Async Iterators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/streaming/callback-handlers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Callback Handlers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3_5" >
        
          
          <label class="md-nav__link" for="__nav_1_3_5" id="__nav_1_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Multi-agent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3_5">
            <span class="md-nav__icon md-icon"></span>
            Multi-agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/multi-agent/agents-as-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents as Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/multi-agent/swarm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Swarm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/multi-agent/graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/concepts/multi-agent/workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Safety & Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Safety & Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safety-security/responsible-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Responsible AI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safety-security/guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guardrails
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safety-security/prompt-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt Engineering
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Observability & Evaluation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Observability & Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/observability-evaluation/observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/observability-evaluation/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/observability-evaluation/traces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Traces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/observability-evaluation/logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/observability-evaluation/evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deploy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Deploy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/operating-agents-in-production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operating Agents in Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/deploy_to_aws_lambda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Lambda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/deploy_to_aws_fargate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Fargate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/deploy_to_amazon_eks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon EKS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/deploy_to_amazon_ec2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon EC2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/cli-reference-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Reference Agent Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/weather_forecaster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Weather Forecaster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/memory_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/file_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/agents_workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/knowledge_base_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge-Base Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/multi_agent_example/multi_agent_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/meta_tooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Meta Tooling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/python/mcp_calculator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/strands-agents/sdk-python/blob/main/CONTRIBUTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribute ❤️
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../event-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Loop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../handlers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Handlers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../telemetry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Telemetry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#strands.tools.tools" class="md-nav__link">
    <span class="md-ellipsis">
      tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.original_function" class="md-nav__link">
    <span class="md-ellipsis">
      original_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.supports_hot_reload" class="md-nav__link">
    <span class="md-ellipsis">
      supports_hot_reload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.get_display_properties" class="md-nav__link">
    <span class="md-ellipsis">
      get_display_properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.InvalidToolUseNameException" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidToolUseNameException
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool" class="md-nav__link">
    <span class="md-ellipsis">
      PythonAgentTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PythonAgentTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.normalize_schema" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.normalize_tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.validate_tool_use" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.validate_tool_use_name" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_use_name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.decorator" class="md-nav__link">
    <span class="md-ellipsis">
      decorator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="decorator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionToolMetadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionToolMetadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.extract_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      extract_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.validate_input" class="md-nav__link">
    <span class="md-ellipsis">
      validate_input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.tool" class="md-nav__link">
    <span class="md-ellipsis">
      tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.executor" class="md-nav__link">
    <span class="md-ellipsis">
      executor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.executor.run_tools" class="md-nav__link">
    <span class="md-ellipsis">
      run_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.executor.validate_and_prepare_tools" class="md-nav__link">
    <span class="md-ellipsis">
      validate_and_prepare_tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader" class="md-nav__link">
    <span class="md-ellipsis">
      ToolLoader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader.load_python_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_python_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader.load_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.load_function_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_function_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.scan_directory_for_tools" class="md-nav__link">
    <span class="md-ellipsis">
      scan_directory_for_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.scan_module_for_tools" class="md-nav__link">
    <span class="md-ellipsis">
      scan_module_for_tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="registry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry" class="md-nav__link">
    <span class="md-ellipsis">
      ToolRegistry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolRegistry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.NewToolDict" class="md-nav__link">
    <span class="md-ellipsis">
      NewToolDict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.discover_tool_modules" class="md-nav__link">
    <span class="md-ellipsis">
      discover_tool_modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.get_all_tools_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_tools_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.get_tools_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      get_tools_dirs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.initialize_tool_config" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_tool_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.initialize_tools" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.load_tool_from_filepath" class="md-nav__link">
    <span class="md-ellipsis">
      load_tool_from_filepath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.process_tools" class="md-nav__link">
    <span class="md-ellipsis">
      process_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.register_tool" class="md-nav__link">
    <span class="md-ellipsis">
      register_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.reload_tool" class="md-nav__link">
    <span class="md-ellipsis">
      reload_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.validate_tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor" class="md-nav__link">
    <span class="md-ellipsis">
      thread_pool_executor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thread_pool_executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper" class="md-nav__link">
    <span class="md-ellipsis">
      ThreadPoolExecutorWrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ThreadPoolExecutorWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.as_completed" class="md-nav__link">
    <span class="md-ellipsis">
      as_completed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.submit" class="md-nav__link">
    <span class="md-ellipsis">
      submit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.watcher" class="md-nav__link">
    <span class="md-ellipsis">
      watcher
    </span>
  </a>
  
    <nav class="md-nav" aria-label="watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher" class="md-nav__link">
    <span class="md-ellipsis">
      ToolWatcher
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler" class="md-nav__link">
    <span class="md-ellipsis">
      MasterChangeHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MasterChangeHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.on_modified" class="md-nav__link">
    <span class="md-ellipsis">
      on_modified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler" class="md-nav__link">
    <span class="md-ellipsis">
      ToolChangeHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolChangeHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.on_modified" class="md-nav__link">
    <span class="md-ellipsis">
      on_modified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.mcp" class="md-nav__link">
    <span class="md-ellipsis">
      mcp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_agent_tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp_agent_tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool" class="md-nav__link">
    <span class="md-ellipsis">
      MCPAgentTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCPAgentTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_client
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient" class="md-nav__link">
    <span class="md-ellipsis">
      MCPClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCPClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.call_tool_sync" class="md-nav__link">
    <span class="md-ellipsis">
      call_tool_sync
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.list_tools_sync" class="md-nav__link">
    <span class="md-ellipsis">
      list_tools_sync
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_types" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#strands.tools.tools" class="md-nav__link">
    <span class="md-ellipsis">
      tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.original_function" class="md-nav__link">
    <span class="md-ellipsis">
      original_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.supports_hot_reload" class="md-nav__link">
    <span class="md-ellipsis">
      supports_hot_reload
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.get_display_properties" class="md-nav__link">
    <span class="md-ellipsis">
      get_display_properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.FunctionTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.InvalidToolUseNameException" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidToolUseNameException
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool" class="md-nav__link">
    <span class="md-ellipsis">
      PythonAgentTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PythonAgentTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.PythonAgentTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.normalize_schema" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.normalize_tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.validate_tool_use" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.tools.validate_tool_use_name" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_use_name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.decorator" class="md-nav__link">
    <span class="md-ellipsis">
      decorator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="decorator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata" class="md-nav__link">
    <span class="md-ellipsis">
      FunctionToolMetadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FunctionToolMetadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.extract_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      extract_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.FunctionToolMetadata.validate_input" class="md-nav__link">
    <span class="md-ellipsis">
      validate_input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.decorator.tool" class="md-nav__link">
    <span class="md-ellipsis">
      tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.executor" class="md-nav__link">
    <span class="md-ellipsis">
      executor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.executor.run_tools" class="md-nav__link">
    <span class="md-ellipsis">
      run_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.executor.validate_and_prepare_tools" class="md-nav__link">
    <span class="md-ellipsis">
      validate_and_prepare_tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader" class="md-nav__link">
    <span class="md-ellipsis">
      ToolLoader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader.load_python_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_python_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.ToolLoader.load_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.load_function_tool" class="md-nav__link">
    <span class="md-ellipsis">
      load_function_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.scan_directory_for_tools" class="md-nav__link">
    <span class="md-ellipsis">
      scan_directory_for_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.loader.scan_module_for_tools" class="md-nav__link">
    <span class="md-ellipsis">
      scan_module_for_tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.registry" class="md-nav__link">
    <span class="md-ellipsis">
      registry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="registry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry" class="md-nav__link">
    <span class="md-ellipsis">
      ToolRegistry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolRegistry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.NewToolDict" class="md-nav__link">
    <span class="md-ellipsis">
      NewToolDict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.discover_tool_modules" class="md-nav__link">
    <span class="md-ellipsis">
      discover_tool_modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.get_all_tools_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_tools_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.get_tools_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      get_tools_dirs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.initialize_tool_config" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_tool_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.initialize_tools" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.load_tool_from_filepath" class="md-nav__link">
    <span class="md-ellipsis">
      load_tool_from_filepath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.process_tools" class="md-nav__link">
    <span class="md-ellipsis">
      process_tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.register_tool" class="md-nav__link">
    <span class="md-ellipsis">
      register_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.reload_tool" class="md-nav__link">
    <span class="md-ellipsis">
      reload_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.registry.ToolRegistry.validate_tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      validate_tool_spec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor" class="md-nav__link">
    <span class="md-ellipsis">
      thread_pool_executor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thread_pool_executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper" class="md-nav__link">
    <span class="md-ellipsis">
      ThreadPoolExecutorWrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ThreadPoolExecutorWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.as_completed" class="md-nav__link">
    <span class="md-ellipsis">
      as_completed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.submit" class="md-nav__link">
    <span class="md-ellipsis">
      submit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.watcher" class="md-nav__link">
    <span class="md-ellipsis">
      watcher
    </span>
  </a>
  
    <nav class="md-nav" aria-label="watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher" class="md-nav__link">
    <span class="md-ellipsis">
      ToolWatcher
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler" class="md-nav__link">
    <span class="md-ellipsis">
      MasterChangeHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MasterChangeHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.on_modified" class="md-nav__link">
    <span class="md-ellipsis">
      on_modified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler" class="md-nav__link">
    <span class="md-ellipsis">
      ToolChangeHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolChangeHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.on_modified" class="md-nav__link">
    <span class="md-ellipsis">
      on_modified
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.watcher.ToolWatcher.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strands.tools.mcp" class="md-nav__link">
    <span class="md-ellipsis">
      mcp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_agent_tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp_agent_tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool" class="md-nav__link">
    <span class="md-ellipsis">
      MCPAgentTool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCPAgentTool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_spec" class="md-nav__link">
    <span class="md-ellipsis">
      tool_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_type" class="md-nav__link">
    <span class="md-ellipsis">
      tool_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.invoke" class="md-nav__link">
    <span class="md-ellipsis">
      invoke
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_client
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mcp_client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient" class="md-nav__link">
    <span class="md-ellipsis">
      MCPClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MCPClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.call_tool_sync" class="md-nav__link">
    <span class="md-ellipsis">
      call_tool_sync
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.list_tools_sync" class="md-nav__link">
    <span class="md-ellipsis">
      list_tools_sync
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_client.MCPClient.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strands.tools.mcp.mcp_types" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="strands.tools" class="doc doc-heading">
            <code>strands.tools</code>


<a href="#strands.tools" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">

        <p>Agent tool interfaces and utilities.</p>
<p>This module provides the core functionality for creating, managing, and executing tools through agents.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.tools" class="doc doc-heading">
            <code>strands.tools.tools</code>


<a href="#strands.tools.tools" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Core tool implementations.</p>
<p>This module provides the base classes for all tool implementations in the SDK, including function-based tools and
Python module-based tools, as well as utilities for validating tool uses and normalizing tool schemas.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.tools.FunctionTool" class="doc doc-heading">
            <code>FunctionTool</code>


<a href="#strands.tools.tools.FunctionTool" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code></p>


        <p>Tool implementation for function-based tools created with @tool.</p>
<p>This class adapts Python functions decorated with @tool to the AgentTool interface.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/tools.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FunctionTool</span><span class="p">(</span><span class="n">AgentTool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool implementation for function-based tools created with @tool.</span>

<span class="sd">    This class adapts Python functions decorated with @tool to the AgentTool interface.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">ToolResult</span><span class="p">],</span> <span class="n">tool_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a function-based tool.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The decorated function.</span>
<span class="sd">            tool_name: Optional tool name (defaults to function name).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If func is not decorated with @tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>

        <span class="c1"># Get TOOL_SPEC from the decorated function</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ToolSpec</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
            <span class="c1"># Use name from tool spec if available, otherwise use function name or passed tool_name</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">tool_name</span> <span class="ow">or</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool name must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not decorated with @tool&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolSpec</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the tool specification for this function-based tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The tool specification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the type of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string &quot;function&quot; indicating this is a function-based tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;function&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">supports_hot_reload</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this tool supports automatic reloading when modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Always true for function-based tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the function with the given tool use request.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool: The tool use request containing the tool name, ID, and input parameters.</span>
<span class="sd">            *args: Additional positional arguments to pass to the function.</span>
<span class="sd">            **kwargs: Additional keyword arguments to pass to the function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ToolResult containing the status and content from the function execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure to pass through all kwargs, including &#39;agent&#39; if provided</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check if the function accepts agent as a keyword argument</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                <span class="c1"># Pass agent if function accepts it</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Skip passing agent if function doesn&#39;t accept it</span>
                <span class="n">filtered_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;agent&quot;</span><span class="p">}</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">**</span><span class="n">filtered_kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error executing function: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
            <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">original_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the original function (without wrapper).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Undecorated function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">,</span> <span class="s2">&quot;original_function&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="o">.</span><span class="n">original_function</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_display_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get properties to display in UI representations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Function properties (e.g., function name).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_display_properties</span><span class="p">()</span>
        <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;Function&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_function</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">return</span> <span class="n">properties</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.FunctionTool.original_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">original_function</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.FunctionTool.original_function" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the original function (without wrapper).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Undecorated function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.FunctionTool.supports_hot_reload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">supports_hot_reload</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.FunctionTool.supports_hot_reload" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Check if this tool supports automatic reloading when modified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Always true for function-based tools.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.FunctionTool.tool_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.FunctionTool.tool_name" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the name of the tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.FunctionTool.tool_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_spec</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.FunctionTool.tool_spec" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the tool specification for this function-based tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool specification.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.FunctionTool.tool_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.FunctionTool.tool_type" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the type of the tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string "function" indicating this is a function-based tool.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="strands.tools.tools.FunctionTool.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">tool_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#strands.tools.tools.FunctionTool.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a function-based tool.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a>, <span title="typing_extensions.Unpack">Unpack</span>[<span title="typing.Any">Any</span>]], <a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decorated function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional tool name (defaults to function name).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If func is not decorated with @tool.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">,</span> <span class="n">Unpack</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">ToolResult</span><span class="p">],</span> <span class="n">tool_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a function-based tool.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The decorated function.</span>
<span class="sd">        tool_name: Optional tool name (defaults to function name).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If func is not decorated with @tool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>

    <span class="c1"># Get TOOL_SPEC from the decorated function</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ToolSpec</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
        <span class="c1"># Use name from tool spec if available, otherwise use function name or passed tool_name</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">tool_name</span> <span class="ow">or</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool name must be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not decorated with @tool&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.tools.FunctionTool.get_display_properties" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_display_properties</span><span class="p">()</span></code>

<a href="#strands.tools.tools.FunctionTool.get_display_properties" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get properties to display in UI representations.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function properties (e.g., function name).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_display_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get properties to display in UI representations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Function properties (e.g., function name).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">properties</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_display_properties</span><span class="p">()</span>
    <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;Function&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_function</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">return</span> <span class="n">properties</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.tools.FunctionTool.invoke" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invoke</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#strands.tools.tools.FunctionTool.invoke" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Execute the function with the given tool use request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool use request containing the tool name, ID, and input parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional positional arguments to pass to the function.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ToolResult containing the status and content from the function execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the function with the given tool use request.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool: The tool use request containing the tool name, ID, and input parameters.</span>
<span class="sd">        *args: Additional positional arguments to pass to the function.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ToolResult containing the status and content from the function execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make sure to pass through all kwargs, including &#39;agent&#39; if provided</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the function accepts agent as a keyword argument</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="c1"># Pass agent if function accepts it</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Skip passing agent if function doesn&#39;t accept it</span>
            <span class="n">filtered_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;agent&quot;</span><span class="p">}</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">**</span><span class="n">filtered_kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">),</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error executing function: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="strands.tools.tools.InvalidToolUseNameException" class="doc doc-heading">
            <code>InvalidToolUseNameException</code>


<a href="#strands.tools.tools.InvalidToolUseNameException" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when a tool use has an invalid name.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/tools.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">InvalidToolUseNameException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a tool use has an invalid name.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="strands.tools.tools.PythonAgentTool" class="doc doc-heading">
            <code>PythonAgentTool</code>


<a href="#strands.tools.tools.PythonAgentTool" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code></p>


        <p>Tool implementation for Python-based tools.</p>
<p>This class handles tools implemented as Python functions, providing a simple interface for executing Python code
as SDK tools.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/tools.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PythonAgentTool</span><span class="p">(</span><span class="n">AgentTool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool implementation for Python-based tools.</span>

<span class="sd">    This class handles tools implemented as Python functions, providing a simple interface for executing Python code</span>
<span class="sd">    as SDK tools.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">ToolResult</span><span class="p">]</span>
    <span class="n">_tool_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">_tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">ToolResult</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a Python-based tool.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_name: Unique identifier for the tool.</span>
<span class="sd">            tool_spec: Tool specification defining parameters and behavior.</span>
<span class="sd">            callback: Python function to execute when the tool is invoked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_name</span> <span class="o">=</span> <span class="n">tool_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span> <span class="o">=</span> <span class="n">tool_spec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolSpec</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the tool specification for this Python-based tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The tool specification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identifies this as a Python-based tool implementation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            &quot;python&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the Python function with the given tool use request.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool: The tool use request.</span>
<span class="sd">            *args: Additional positional arguments to pass to the underlying callback function.</span>
<span class="sd">            **kwargs: Additional keyword arguments to pass to the underlying callback function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ToolResult containing the status and content from the callback execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.PythonAgentTool.tool_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.PythonAgentTool.tool_name" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the name of the tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the tool.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.PythonAgentTool.tool_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_spec</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.PythonAgentTool.tool_spec" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the tool specification for this Python-based tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool specification.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="strands.tools.tools.PythonAgentTool.tool_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.tools.PythonAgentTool.tool_type" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Identifies this as a Python-based tool implementation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"python".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="strands.tools.tools.PythonAgentTool.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

<a href="#strands.tools.tools.PythonAgentTool.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a Python-based tool.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for the tool.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_spec</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool specification defining parameters and behavior.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a>, <span title="typing.Any">Any</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]], <a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Python function to execute when the tool is invoked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">ToolResult</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a Python-based tool.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_name: Unique identifier for the tool.</span>
<span class="sd">        tool_spec: Tool specification defining parameters and behavior.</span>
<span class="sd">        callback: Python function to execute when the tool is invoked.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_name</span> <span class="o">=</span> <span class="n">tool_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tool_spec</span> <span class="o">=</span> <span class="n">tool_spec</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.tools.PythonAgentTool.invoke" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invoke</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#strands.tools.tools.PythonAgentTool.invoke" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Execute the Python function with the given tool use request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool use request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional positional arguments to pass to the underlying callback function.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the underlying callback function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ToolResult containing the status and content from the callback execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the Python function with the given tool use request.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool: The tool use request.</span>
<span class="sd">        *args: Additional positional arguments to pass to the underlying callback function.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the underlying callback function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ToolResult containing the status and content from the callback execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="strands.tools.tools.normalize_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span></code>

<a href="#strands.tools.tools.normalize_schema" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Normalize a JSON schema to match expectations.</p>
<p>This function recursively processes nested objects to preserve the complete schema structure.
Uses a copy-then-normalize approach to preserve all original schema properties.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The schema to normalize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The normalized schema.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize a JSON schema to match expectations.</span>

<span class="sd">    This function recursively processes nested objects to preserve the complete schema structure.</span>
<span class="sd">    Uses a copy-then-normalize approach to preserve all original schema properties.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema to normalize.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The normalized schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a complete copy to preserve all existing properties</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Ensure essential structure exists</span>
    <span class="n">normalized</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span>
    <span class="n">normalized</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">normalized</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;required&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="c1"># Process properties recursively</span>
    <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_def</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_normalize_property</span><span class="p">(</span><span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_def</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">normalized</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.tools.normalize_tool_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_tool_spec</span><span class="p">(</span><span class="n">tool_spec</span><span class="p">)</span></code>

<a href="#strands.tools.tools.normalize_tool_spec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Normalize a complete tool specification by transforming its inputSchema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_spec</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool specification to normalize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The normalized tool specification.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize_tool_spec</span><span class="p">(</span><span class="n">tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolSpec</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize a complete tool specification by transforming its inputSchema.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_spec: The tool specification to normalize.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The normalized tool specification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="n">tool_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Handle inputSchema</span>
    <span class="k">if</span> <span class="s2">&quot;inputSchema&quot;</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;json&quot;</span> <span class="ow">in</span> <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]:</span>
                <span class="c1"># Schema is already in correct format, just normalize inner schema</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">][</span><span class="s2">&quot;json&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalize_schema</span><span class="p">(</span><span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">][</span><span class="s2">&quot;json&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Convert direct schema to proper format</span>
                <span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">normalize_schema</span><span class="p">(</span><span class="n">normalized</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">])}</span>

    <span class="k">return</span> <span class="n">normalized</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.tools.validate_tool_use" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_tool_use</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></code>

<a href="#strands.tools.tools.validate_tool_use" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate a tool use request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool use to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_tool_use</span><span class="p">(</span><span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate a tool use request.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool: The tool use to validate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_tool_use_name</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.tools.validate_tool_use_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_tool_use_name</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></code>

<a href="#strands.tools.tools.validate_tool_use_name" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate the name of a tool use.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool use to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidToolUseNameException (strands.tools.tools.InvalidToolUseNameException)" href="#strands.tools.tools.InvalidToolUseNameException">InvalidToolUseNameException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool name is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/tools.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_tool_use_name</span><span class="p">(</span><span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate the name of a tool use.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool: The tool use to validate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidToolUseNameException: If the tool name is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We need to fix some typing here, because we don&#39;t actually expect a ToolUse, but dict[str, Any]</span>
    <span class="k">if</span> <span class="s2">&quot;name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;tool name missing&quot;</span>  <span class="c1"># type: ignore[unreachable]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">InvalidToolUseNameException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="n">tool_name_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^[a-zA-Z][a-zA-Z0-9_\-]*$&quot;</span>
    <span class="n">tool_name_max_length</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">valid_name_pattern</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">tool_name_pattern</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">))</span>
    <span class="n">tool_name_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_name_pattern</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&gt; | invalid tool name pattern&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">InvalidToolUseNameException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tool_name_len</span> <span class="o">&gt;</span> <span class="n">tool_name_max_length</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&gt;, tool_name_max_length=&lt;</span><span class="si">{</span><span class="n">tool_name_max_length</span><span class="si">}</span><span class="s2">&gt; | invalid tool name length&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">InvalidToolUseNameException</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.decorator" class="doc doc-heading">
            <code>strands.tools.decorator</code>


<a href="#strands.tools.decorator" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Tool decorator for SDK.</p>
<p>This module provides the @tool decorator that transforms Python functions into SDK Agent tools with automatic metadata
extraction and validation.</p>
<p>The @tool decorator performs several functions:</p>
<ol>
<li>Extracts function metadata (name, description, parameters) from docstrings and type hints</li>
<li>Generates a JSON schema for input validation</li>
<li>Handles two different calling patterns:</li>
<li>Standard function calls (func(arg1, arg2))</li>
<li>Tool use calls (agent.my_tool(param1="hello", param2=123))</li>
<li>Provides error handling and result formatting</li>
<li>Works with both standalone functions and class methods</li>
</ol>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">strands</span><span class="w"> </span><span class="kn">import</span> <span class="n">Agent</span><span class="p">,</span> <span class="n">tool</span>

<span class="nd">@tool</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_tool</span><span class="p">(</span><span class="n">param1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Tool description - explain what it does.</span>

<span class="sd">    #Args:</span>
<span class="sd">        param1: Description of first parameter.</span>
<span class="sd">        param2: Description of second parameter (default: 42).</span>

<span class="sd">    #Returns:</span>
<span class="sd">        A dictionary with the results.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">do_something</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}]</span>
    <span class="p">}</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">my_tool</span><span class="p">])</span>
<span class="n">agent</span><span class="o">.</span><span class="n">my_tool</span><span class="p">(</span><span class="n">param1</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="n">param2</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</code></pre></div>
</details>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.decorator.FunctionToolMetadata" class="doc doc-heading">
            <code>FunctionToolMetadata</code>


<a href="#strands.tools.decorator.FunctionToolMetadata" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Helper class to extract and manage function metadata for tool decoration.</p>
<p>This class handles the extraction of metadata from Python functions including:</p>
<ul>
<li>Function name and description from docstrings</li>
<li>Parameter names, types, and descriptions</li>
<li>Return type information</li>
<li>Creation of Pydantic models for input validation</li>
</ul>
<p>The extracted metadata is used to generate a tool specification that can be used by Strands Agent to understand and
validate tool usage.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/decorator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FunctionToolMetadata</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper class to extract and manage function metadata for tool decoration.</span>

<span class="sd">    This class handles the extraction of metadata from Python functions including:</span>

<span class="sd">    - Function name and description from docstrings</span>
<span class="sd">    - Parameter names, types, and descriptions</span>
<span class="sd">    - Return type information</span>
<span class="sd">    - Creation of Pydantic models for input validation</span>

<span class="sd">    The extracted metadata is used to generate a tool specification that can be used by Strands Agent to understand and</span>
<span class="sd">    validate tool usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with the function to process.</span>

<span class="sd">        Args:</span>
<span class="sd">            func: The function to extract metadata from.</span>
<span class="sd">                 Can be a standalone function or a class method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

        <span class="c1"># Parse the docstring with docstring_parser</span>
        <span class="n">doc_str</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">docstring_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">doc_str</span><span class="p">)</span>

        <span class="c1"># Get parameter descriptions from parsed docstring</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_descriptions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">param</span><span class="o">.</span><span class="n">arg_name</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Parameter </span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">params</span>
        <span class="p">}</span>

        <span class="c1"># Create a Pydantic model for validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_input_model</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_input_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Pydantic model from function signature for input validation.</span>

<span class="sd">        This method analyzes the function&#39;s signature, type hints, and docstring to create a Pydantic model that can</span>
<span class="sd">        validate input data before passing it to the function.</span>

<span class="sd">        Special parameters like &#39;self&#39;, &#39;cls&#39;, and &#39;agent&#39; are excluded from the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Pydantic BaseModel class customized for the function&#39;s parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">field_definitions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Skip special parameters</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;self&quot;</span><span class="p">,</span> <span class="s2">&quot;cls&quot;</span><span class="p">,</span> <span class="s2">&quot;agent&quot;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Get parameter type and default</span>
            <span class="n">param_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
            <span class="n">default</span> <span class="o">=</span> <span class="o">...</span> <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span> <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span>
            <span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_descriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Parameter </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Create Field with description and default</span>
            <span class="n">field_definitions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_type</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">))</span>

        <span class="c1"># Create model name based on function name</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">Tool&quot;</span>

        <span class="c1"># Create and return the model</span>
        <span class="k">if</span> <span class="n">field_definitions</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">create_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="o">**</span><span class="n">field_definitions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Handle case with no parameters</span>
            <span class="k">return</span> <span class="n">create_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract metadata from the function to create a tool specification.</span>

<span class="sd">        This method analyzes the function to create a standardized tool specification that Strands Agent can use to</span>
<span class="sd">        understand and interact with the tool.</span>

<span class="sd">        The specification includes:</span>

<span class="sd">        - name: The function name (or custom override)</span>
<span class="sd">        - description: The function&#39;s docstring</span>
<span class="sd">        - inputSchema: A JSON schema describing the expected parameters</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary containing the tool specification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>

        <span class="c1"># Extract function description from docstring, preserving paragraph breaks</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">func_name</span>

        <span class="c1"># Get schema directly from the Pydantic model</span>
        <span class="n">input_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span><span class="o">.</span><span class="n">model_json_schema</span><span class="p">()</span>

        <span class="c1"># Clean up Pydantic-specific schema elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clean_pydantic_schema</span><span class="p">(</span><span class="n">input_schema</span><span class="p">)</span>

        <span class="c1"># Create tool specification</span>
        <span class="n">tool_spec</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">func_name</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;inputSchema&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">input_schema</span><span class="p">}}</span>

        <span class="k">return</span> <span class="n">tool_spec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_clean_pydantic_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up Pydantic schema to match Strands&#39; expected format.</span>

<span class="sd">        Pydantic&#39;s JSON schema output includes several elements that aren&#39;t needed for Strands Agent tools and could</span>
<span class="sd">        cause validation issues. This method removes those elements and simplifies complex type structures.</span>

<span class="sd">        Key operations:</span>

<span class="sd">        1. Remove Pydantic-specific metadata (title, $defs, etc.)</span>
<span class="sd">        2. Process complex types like Union and Optional to simpler formats</span>
<span class="sd">        3. Handle nested property structures recursively</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The Pydantic-generated JSON schema to clean up (modified in place).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove Pydantic metadata</span>
        <span class="n">keys_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;$defs&quot;</span><span class="p">,</span> <span class="s2">&quot;additionalProperties&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">schema</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="c1"># Process properties to clean up anyOf and similar structures</span>
        <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_prop_name</span><span class="p">,</span> <span class="n">prop_schema</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Handle anyOf constructs (common for Optional types)</span>
                <span class="k">if</span> <span class="s2">&quot;anyOf&quot;</span> <span class="ow">in</span> <span class="n">prop_schema</span><span class="p">:</span>
                    <span class="n">any_of</span> <span class="o">=</span> <span class="n">prop_schema</span><span class="p">[</span><span class="s2">&quot;anyOf&quot;</span><span class="p">]</span>
                    <span class="c1"># Handle Optional[Type] case (represented as anyOf[Type, null])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">any_of</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;null&quot;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">any_of</span><span class="p">):</span>
                        <span class="c1"># Find the non-null type</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">any_of</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;null&quot;</span><span class="p">:</span>
                                <span class="c1"># Copy the non-null properties to the main schema</span>
                                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                    <span class="n">prop_schema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                                <span class="c1"># Remove the anyOf construct</span>
                                <span class="k">del</span> <span class="n">prop_schema</span><span class="p">[</span><span class="s2">&quot;anyOf&quot;</span><span class="p">]</span>
                                <span class="k">break</span>

                <span class="c1"># Clean up nested properties recursively</span>
                <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">prop_schema</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_clean_pydantic_schema</span><span class="p">(</span><span class="n">prop_schema</span><span class="p">)</span>

                <span class="c1"># Remove any remaining Pydantic metadata from properties</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">prop_schema</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">prop_schema</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate input data using the Pydantic model.</span>

<span class="sd">        This method ensures that the input data meets the expected schema before it&#39;s passed to the actual function. It</span>
<span class="sd">        converts the data to the correct types when possible and raises informative errors when not.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data: A dictionary of parameter names and values to validate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary with validated and converted parameter values.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the input data fails validation, with details about what failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Validate with Pydantic model</span>
            <span class="n">validated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span><span class="p">(</span><span class="o">**</span><span class="n">input_data</span><span class="p">)</span>

            <span class="c1"># Return as dict</span>
            <span class="k">return</span> <span class="n">validated</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Re-raise with more detailed error message</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation failed for input parameters: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="strands.tools.decorator.FunctionToolMetadata.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#strands.tools.decorator.FunctionToolMetadata.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize with the function to process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to extract metadata from.
 Can be a standalone function or a class method.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/decorator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with the function to process.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to extract metadata from.</span>
<span class="sd">             Can be a standalone function or a class method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type_hints</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="c1"># Parse the docstring with docstring_parser</span>
    <span class="n">doc_str</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">docstring_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">doc_str</span><span class="p">)</span>

    <span class="c1"># Get parameter descriptions from parsed docstring</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">param_descriptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">param</span><span class="o">.</span><span class="n">arg_name</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Parameter </span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">params</span>
    <span class="p">}</span>

    <span class="c1"># Create a Pydantic model for validation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_input_model</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.decorator.FunctionToolMetadata.extract_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_metadata</span><span class="p">()</span></code>

<a href="#strands.tools.decorator.FunctionToolMetadata.extract_metadata" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extract metadata from the function to create a tool specification.</p>
<p>This method analyzes the function to create a standardized tool specification that Strands Agent can use to
understand and interact with the tool.</p>
<p>The specification includes:</p>
<ul>
<li>name: The function name (or custom override)</li>
<li>description: The function's docstring</li>
<li>inputSchema: A JSON schema describing the expected parameters</li>
</ul>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the tool specification.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/decorator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract metadata from the function to create a tool specification.</span>

<span class="sd">    This method analyzes the function to create a standardized tool specification that Strands Agent can use to</span>
<span class="sd">    understand and interact with the tool.</span>

<span class="sd">    The specification includes:</span>

<span class="sd">    - name: The function name (or custom override)</span>
<span class="sd">    - description: The function&#39;s docstring</span>
<span class="sd">    - inputSchema: A JSON schema describing the expected parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary containing the tool specification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">func_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="c1"># Extract function description from docstring, preserving paragraph breaks</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">func_name</span>

    <span class="c1"># Get schema directly from the Pydantic model</span>
    <span class="n">input_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span><span class="o">.</span><span class="n">model_json_schema</span><span class="p">()</span>

    <span class="c1"># Clean up Pydantic-specific schema elements</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_clean_pydantic_schema</span><span class="p">(</span><span class="n">input_schema</span><span class="p">)</span>

    <span class="c1"># Create tool specification</span>
    <span class="n">tool_spec</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">func_name</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> <span class="s2">&quot;inputSchema&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">input_schema</span><span class="p">}}</span>

    <span class="k">return</span> <span class="n">tool_spec</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.decorator.FunctionToolMetadata.validate_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_input</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span></code>

<a href="#strands.tools.decorator.FunctionToolMetadata.validate_input" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Validate input data using the Pydantic model.</p>
<p>This method ensures that the input data meets the expected schema before it's passed to the actual function. It
converts the data to the correct types when possible and raises informative errors when not.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of parameter names and values to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with validated and converted parameter values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input data fails validation, with details about what failed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/decorator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate input data using the Pydantic model.</span>

<span class="sd">    This method ensures that the input data meets the expected schema before it&#39;s passed to the actual function. It</span>
<span class="sd">    converts the data to the correct types when possible and raises informative errors when not.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data: A dictionary of parameter names and values to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with validated and converted parameter values.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the input data fails validation, with details about what failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Validate with Pydantic model</span>
        <span class="n">validated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_model</span><span class="p">(</span><span class="o">**</span><span class="n">input_data</span><span class="p">)</span>

        <span class="c1"># Return as dict</span>
        <span class="k">return</span> <span class="n">validated</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Re-raise with more detailed error message</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation failed for input parameters: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="strands.tools.decorator.tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">tool_kwargs</span><span class="p">)</span></code>

<a href="#strands.tools.decorator.tool" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Decorator that transforms a Python function into a Strands tool.</p>
<p>This decorator seamlessly enables a function to be called both as a regular Python function and as a Strands tool.
It extracts metadata from the function's signature, docstring, and type hints to generate an OpenAPI-compatible tool
specification.</p>
<p>When decorated, a function:</p>
<ol>
<li>Still works as a normal function when called directly with arguments</li>
<li>Processes tool use API calls when provided with a tool use dictionary</li>
<li>Validates inputs against the function's type hints and parameter spec</li>
<li>Formats return values according to the expected Strands tool result format</li>
<li>Provides automatic error handling and reporting</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to decorate.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**tool_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional tool specification options to override extracted values.
E.g., <code>name="custom_name", description="Custom description"</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="strands.tools.decorator.T">T</span>], <span title="strands.tools.decorator.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decorated function with attached tool specifications.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="nd">@tool</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Does something useful with the provided parameters.</span>

<span class="sd">    &quot;Args:</span>
<span class="sd">        name: The name to process</span>
<span class="sd">        count: Number of times to process (default: 1)</span>

<span class="sd">    &quot;Returns:</span>
<span class="sd">        A message with the result</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> times&quot;</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">my_tool</span><span class="p">])</span>
<span class="n">agent</span><span class="o">.</span><span class="n">my_tool</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># Returns: {</span>
<span class="c1">#   &quot;toolUseId&quot;: &quot;123&quot;,</span>
<span class="c1">#   &quot;status&quot;: &quot;success&quot;,</span>
<span class="c1">#   &quot;content&quot;: [{&quot;text&quot;: &quot;Processed example 3 times&quot;}]</span>
<span class="c1"># }</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>strands/tools/decorator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">tool_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator that transforms a Python function into a Strands tool.</span>

<span class="sd">    This decorator seamlessly enables a function to be called both as a regular Python function and as a Strands tool.</span>
<span class="sd">    It extracts metadata from the function&#39;s signature, docstring, and type hints to generate an OpenAPI-compatible tool</span>
<span class="sd">    specification.</span>

<span class="sd">    When decorated, a function:</span>

<span class="sd">    1. Still works as a normal function when called directly with arguments</span>
<span class="sd">    2. Processes tool use API calls when provided with a tool use dictionary</span>
<span class="sd">    3. Validates inputs against the function&#39;s type hints and parameter spec</span>
<span class="sd">    4. Formats return values according to the expected Strands tool result format</span>
<span class="sd">    5. Provides automatic error handling and reporting</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to decorate.</span>
<span class="sd">        **tool_kwargs: Additional tool specification options to override extracted values.</span>
<span class="sd">            E.g., `name=&quot;custom_name&quot;, description=&quot;Custom description&quot;`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The decorated function with attached tool specifications.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        @tool</span>
<span class="sd">        def my_tool(name: str, count: int = 1) -&gt; str:</span>
<span class="sd">            &#39;&#39;&#39;Does something useful with the provided parameters.</span>

<span class="sd">            &quot;Args:</span>
<span class="sd">                name: The name to process</span>
<span class="sd">                count: Number of times to process (default: 1)</span>

<span class="sd">            &quot;Returns:</span>
<span class="sd">                A message with the result</span>
<span class="sd">            &#39;&#39;&#39;</span>
<span class="sd">            return f&quot;Processed {name} {count} times&quot;</span>

<span class="sd">        agent = Agent(tools=[my_tool])</span>
<span class="sd">        agent.my_tool(name=&quot;example&quot;, count=3)</span>
<span class="sd">        # Returns: {</span>
<span class="sd">        #   &quot;toolUseId&quot;: &quot;123&quot;,</span>
<span class="sd">        #   &quot;status&quot;: &quot;success&quot;,</span>
<span class="sd">        #   &quot;content&quot;: [{&quot;text&quot;: &quot;Processed example 3 times&quot;}]</span>
<span class="sd">        # }</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="c1"># Create function tool metadata</span>
        <span class="n">tool_meta</span> <span class="o">=</span> <span class="n">FunctionToolMetadata</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">tool_spec</span> <span class="o">=</span> <span class="n">tool_meta</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">()</span>

        <span class="c1"># Update with any additional kwargs</span>
        <span class="n">tool_spec</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tool_kwargs</span><span class="p">)</span>

        <span class="c1"># Attach TOOL_SPEC directly to the original function (critical for backward compatibility)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">TOOL_SPEC</span> <span class="o">=</span> <span class="n">tool_spec</span>  <span class="c1"># type: ignore</span>

        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Tool wrapper.</span>

<span class="sd">            This wrapper handles two different calling patterns:</span>

<span class="sd">            1. Normal function calls: `func(arg1, arg2, ...)`</span>
<span class="sd">            2. Tool use calls: `func({&quot;toolUseId&quot;: &quot;id&quot;, &quot;input&quot;: {...}}, agent=agent)`</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Initialize variables to track call type</span>
            <span class="n">is_method_call</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># DETECT IF THIS IS A METHOD CALL (with &#39;self&#39; as first argument)</span>
            <span class="c1"># If this is a method call, the first arg would be &#39;self&#39; (instance)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Try to find f in the class of args[0]</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;__class__&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="p">):</span>
                            <span class="c1"># This is likely a method call with self as first argument</span>
                            <span class="n">is_method_call</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Remove self from args</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="k">pass</span>

            <span class="c1"># DETECT IF THIS IS A TOOL USE CALL</span>
            <span class="c1"># Check if this is a tool use call (dict with toolUseId or input)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;toolUseId&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;input&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">):</span>
                <span class="c1"># This is a tool use call - process accordingly</span>
                <span class="n">tool_use</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tool_use_id</span> <span class="o">=</span> <span class="n">tool_use</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
                <span class="n">tool_input</span> <span class="o">=</span> <span class="n">tool_use</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="p">{})</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Validate input against the Pydantic model</span>
                    <span class="n">validated_input</span> <span class="o">=</span> <span class="n">tool_meta</span><span class="o">.</span><span class="n">validate_input</span><span class="p">(</span><span class="n">tool_input</span><span class="p">)</span>

                    <span class="c1"># Pass along the agent if provided and expected by the function</span>
                    <span class="k">if</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">tool_meta</span><span class="o">.</span><span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
                        <span class="n">validated_input</span><span class="p">[</span><span class="s2">&quot;agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;agent&quot;</span><span class="p">)</span>

                    <span class="c1"># CALL THE ACTUAL FUNCTION based on whether it&#39;s a method or not</span>
                    <span class="k">if</span> <span class="n">is_method_call</span><span class="p">:</span>
                        <span class="c1"># For methods, pass the instance as &#39;self&#39;</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">validated_input</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># For standalone functions, just pass the validated inputs</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">**</span><span class="n">validated_input</span><span class="p">)</span>

                    <span class="c1"># FORMAT THE RESULT for Strands Agent</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;status&quot;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="s2">&quot;content&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                        <span class="c1"># Result is already in the expected format, just add toolUseId</span>
                        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool_use_id</span>
                        <span class="k">return</span> <span class="n">result</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Wrap any other return value in the standard format</span>
                        <span class="c1"># Always include at least one content item for consistency</span>
                        <span class="k">return</span> <span class="p">{</span>
                            <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool_use_id</span><span class="p">,</span>
                            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)}],</span>
                        <span class="p">}</span>

                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Special handling for validation errors</span>
                    <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool_use_id</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
                    <span class="p">}</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Return error result with exception details for any other error</span>
                    <span class="n">error_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                    <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span>
                        <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool_use_id</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error_type</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
                    <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># NORMAL FUNCTION CALL - pass through to the original function</span>
                <span class="k">if</span> <span class="n">is_method_call</span><span class="p">:</span>
                    <span class="c1"># Put instance back as first argument for method calls</span>
                    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Standard function call</span>
                    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Also attach TOOL_SPEC to wrapper for compatibility</span>
        <span class="n">wrapper</span><span class="o">.</span><span class="n">TOOL_SPEC</span> <span class="o">=</span> <span class="n">tool_spec</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># Return the wrapper</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">wrapper</span><span class="p">)</span>

    <span class="c1"># Handle both @tool and @tool() syntax</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">decorator</span>
    <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.executor" class="doc doc-heading">
            <code>strands.tools.executor</code>


<a href="#strands.tools.executor" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Tool execution functionality for the event loop.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="strands.tools.executor.run_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_tools</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">tool_uses</span><span class="p">,</span> <span class="n">event_loop_metrics</span><span class="p">,</span> <span class="n">request_state</span><span class="p">,</span> <span class="n">invalid_tool_use_ids</span><span class="p">,</span> <span class="n">tool_results</span><span class="p">,</span> <span class="n">cycle_trace</span><span class="p">,</span> <span class="n">parent_span</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel_tool_executor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#strands.tools.executor.run_tools" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Execute tools either in parallel or sequentially.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>handler</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a>], <a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool handler processing function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_uses</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tool uses to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_loop_metrics</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventLoopMetrics


  
      dataclass
   (strands.telemetry.metrics.EventLoopMetrics)" href="../telemetry/#strands.telemetry.metrics.EventLoopMetrics">EventLoopMetrics</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metrics collection object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_state</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current request state.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>invalid_tool_use_ids</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of invalid tool use IDs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_results</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List to populate with tool results.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cycle_trace</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Trace (strands.telemetry.metrics.Trace)" href="../telemetry/#strands.telemetry.metrics.Trace">Trace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parent trace for the current cycle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent_span</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="opentelemetry.trace.Span">Span</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parent span for the current cycle.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parallel_tool_executor</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="ParallelToolExecutorInterface (strands.types.event_loop.ParallelToolExecutorInterface)" href="../types/#strands.types.event_loop.ParallelToolExecutorInterface">ParallelToolExecutorInterface</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional executor for parallel processing.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if any tool failed, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_tools</span><span class="p">(</span>
    <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ToolUse</span><span class="p">],</span> <span class="n">ToolResult</span><span class="p">],</span>
    <span class="n">tool_uses</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolUse</span><span class="p">],</span>
    <span class="n">event_loop_metrics</span><span class="p">:</span> <span class="n">EventLoopMetrics</span><span class="p">,</span>
    <span class="n">request_state</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">invalid_tool_use_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">tool_results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolResult</span><span class="p">],</span>
    <span class="n">cycle_trace</span><span class="p">:</span> <span class="n">Trace</span><span class="p">,</span>
    <span class="n">parent_span</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">trace</span><span class="o">.</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parallel_tool_executor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ParallelToolExecutorInterface</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute tools either in parallel or sequentially.</span>

<span class="sd">    Args:</span>
<span class="sd">        handler: Tool handler processing function.</span>
<span class="sd">        tool_uses: List of tool uses to execute.</span>
<span class="sd">        event_loop_metrics: Metrics collection object.</span>
<span class="sd">        request_state: Current request state.</span>
<span class="sd">        invalid_tool_use_ids: List of invalid tool use IDs.</span>
<span class="sd">        tool_results: List to populate with tool results.</span>
<span class="sd">        cycle_trace: Parent trace for the current cycle.</span>
<span class="sd">        parent_span: Parent span for the current cycle.</span>
<span class="sd">        parallel_tool_executor: Optional executor for parallel processing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if any tool failed, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_handle_tool_execution</span><span class="p">(</span><span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ToolResult</span><span class="p">]]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tool_succeeded</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">tracer</span> <span class="o">=</span> <span class="n">get_tracer</span><span class="p">()</span>
        <span class="n">tool_call_span</span> <span class="o">=</span> <span class="n">tracer</span><span class="o">.</span><span class="n">start_tool_call_span</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">parent_span</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;toolUseId&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool</span> <span class="ow">or</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">invalid_tool_use_ids</span><span class="p">:</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                <span class="n">tool_trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">parent_id</span><span class="o">=</span><span class="n">cycle_trace</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">raw_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="n">tool_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">handler</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                <span class="n">tool_success</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span>
                <span class="k">if</span> <span class="n">tool_success</span><span class="p">:</span>
                    <span class="n">tool_succeeded</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">tool_duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tool_start_time</span>
                <span class="n">message</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;toolResult&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">}])</span>
                <span class="n">event_loop_metrics</span><span class="o">.</span><span class="n">add_tool_usage</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">tool_duration</span><span class="p">,</span> <span class="n">tool_trace</span><span class="p">,</span> <span class="n">tool_success</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
                <span class="n">cycle_trace</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">tool_trace</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tool_call_span</span><span class="p">:</span>
                <span class="n">tracer</span><span class="o">.</span><span class="n">end_tool_call_span</span><span class="p">(</span><span class="n">tool_call_span</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tool_call_span</span><span class="p">:</span>
                <span class="n">tracer</span><span class="o">.</span><span class="n">end_span_with_error</span><span class="p">(</span><span class="n">tool_call_span</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tool_succeeded</span><span class="p">,</span> <span class="n">result</span>

    <span class="n">any_tool_failed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">parallel_tool_executor</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;tool_count=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_executor=&lt;</span><span class="si">%s</span><span class="s2">&gt; | executing tools in parallel&quot;</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">tool_uses</span><span class="p">),</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">parallel_tool_executor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Submit all tasks with their associated tools</span>
        <span class="n">future_to_tool</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">parallel_tool_executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">_handle_tool_execution</span><span class="p">,</span> <span class="n">tool_use</span><span class="p">):</span> <span class="n">tool_use</span> <span class="k">for</span> <span class="n">tool_use</span> <span class="ow">in</span> <span class="n">tool_uses</span>
        <span class="p">}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_count=&lt;</span><span class="si">%s</span><span class="s2">&gt; | submitted tasks to parallel executor&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_uses</span><span class="p">))</span>

        <span class="c1"># Collect results truly in parallel using the provided executor&#39;s as_completed method</span>
        <span class="n">completed_results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">parallel_tool_executor</span><span class="o">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">future_to_tool</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">succeeded</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">completed_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">succeeded</span><span class="p">:</span>
                        <span class="n">any_tool_failed</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">tool</span> <span class="o">=</span> <span class="n">future_to_tool</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool execution failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">e</span><span class="p">)</span>
                    <span class="n">any_tool_failed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;timeout_seconds=&lt;</span><span class="si">%s</span><span class="s2">&gt; | parallel tool execution timed out&quot;</span><span class="p">,</span> <span class="n">parallel_tool_executor</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
            <span class="c1"># Process any completed tasks</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">future_to_tool</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">succeeded</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">completed_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">tool_e</span><span class="p">:</span>
                        <span class="n">tool</span> <span class="o">=</span> <span class="n">future_to_tool</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool execution failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">tool_e</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># This future didn&#39;t complete within the timeout</span>
                    <span class="n">tool</span> <span class="o">=</span> <span class="n">future_to_tool</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool execution timed out&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="n">any_tool_failed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Add completed results to tool_results</span>
        <span class="n">tool_results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">completed_results</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Sequential execution fallback</span>
        <span class="k">for</span> <span class="n">tool_use</span> <span class="ow">in</span> <span class="n">tool_uses</span><span class="p">:</span>
            <span class="n">succeeded</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">_handle_tool_execution</span><span class="p">(</span><span class="n">tool_use</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tool_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">succeeded</span><span class="p">:</span>
                <span class="n">any_tool_failed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">any_tool_failed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.executor.validate_and_prepare_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_and_prepare_tools</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">tool_uses</span><span class="p">,</span> <span class="n">tool_results</span><span class="p">,</span> <span class="n">invalid_tool_use_ids</span><span class="p">)</span></code>

<a href="#strands.tools.executor.validate_and_prepare_tools" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate tool uses and prepare them for execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message (strands.types.content.Message)" href="../types/#strands.types.content.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current message.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_uses</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="ToolUse (strands.types.tools.ToolUse)" href="../types/#strands.types.tools.ToolUse">ToolUse</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List to populate with tool uses.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_results</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List to populate with tool results for invalid tools.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>invalid_tool_use_ids</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List to populate with invalid tool use IDs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_and_prepare_tools</span><span class="p">(</span>
    <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
    <span class="n">tool_uses</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolUse</span><span class="p">],</span>
    <span class="n">tool_results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolResult</span><span class="p">],</span>
    <span class="n">invalid_tool_use_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate tool uses and prepare them for execution.</span>

<span class="sd">    Args:</span>
<span class="sd">        message: Current message.</span>
<span class="sd">        tool_uses: List to populate with tool uses.</span>
<span class="sd">        tool_results: List to populate with tool results for invalid tools.</span>
<span class="sd">        invalid_tool_use_ids: List to populate with invalid tool use IDs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract tool uses from message</span>
    <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">message</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;toolUse&quot;</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
            <span class="n">tool_uses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">content</span><span class="p">[</span><span class="s2">&quot;toolUse&quot;</span><span class="p">])</span>

    <span class="c1"># Validate tool uses</span>
    <span class="c1"># Avoid modifying original `tool_uses` variable during iteration</span>
    <span class="n">tool_uses_copy</span> <span class="o">=</span> <span class="n">tool_uses</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tool_uses_copy</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validate_tool_use</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidToolUseNameException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Replace the invalid toolUse name and return invalid name error as ToolResult to the LLM as context</span>
            <span class="n">tool_uses</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
            <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;INVALID_TOOL_NAME&quot;</span>
            <span class="n">invalid_tool_use_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">])</span>
            <span class="n">tool_uses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
            <span class="n">tool_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;toolUseId&quot;</span><span class="p">:</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
                <span class="p">}</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.loader" class="doc doc-heading">
            <code>strands.tools.loader</code>


<a href="#strands.tools.loader" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Tool loading utilities.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.loader.ToolLoader" class="doc doc-heading">
            <code>ToolLoader</code>


<a href="#strands.tools.loader.ToolLoader" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Handles loading of tools from different sources.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/loader.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ToolLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles loading of tools from different sources.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_python_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentTool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Python tool module.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_path: Path to the Python tool file.</span>
<span class="sd">            tool_name: Name of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tool instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If required attributes are missing from the tool module.</span>
<span class="sd">            ImportError: If there are issues importing the tool module.</span>
<span class="sd">            TypeError: If the tool function is not callable.</span>
<span class="sd">            ValueError: If function in module is not a valid tool.</span>
<span class="sd">            Exception: For other errors during tool loading.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check if tool_path is in the format &quot;package.module:function&quot;; but keep in mind windows whose file path</span>
            <span class="c1"># could have a colon so also ensure that it&#39;s not a file</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">tool_path</span><span class="p">:</span>
                <span class="n">module_path</span><span class="p">,</span> <span class="n">function_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | importing tool from path&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Import the module</span>
                    <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">fromlist</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">])</span>

                    <span class="c1"># Get the function</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">function_name</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> has no function named </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">function_name</span><span class="p">)</span>

                    <span class="c1"># Check if the function has a TOOL_SPEC (from @tool decorator)</span>
                    <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                            <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found function-based tool&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="p">,</span> <span class="n">module_path</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> is not a valid tool (missing @tool decorator)&quot;</span>
                        <span class="p">)</span>

                <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to import module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

            <span class="c1"># Normal file-based tool loading</span>
            <span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loading python tool from path&quot;</span><span class="p">,</span> <span class="n">abs_path</span><span class="p">)</span>

            <span class="c1"># First load the module to get TOOL_SPEC and check for Lambda deployment</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">abs_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not create spec for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No loader available for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

            <span class="c1"># First, check for function-based tools with @tool decorator</span>
            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="c1"># Check if this is a function with TOOL_SPEC attached (from @tool decorator)</span>
                <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found function-based tool in path&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">tool_path</span>
                    <span class="p">)</span>
                    <span class="c1"># Return as FunctionTool</span>
                    <span class="k">return</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

            <span class="c1"># If no function-based tools found, fall back to traditional module-level tool</span>
            <span class="n">tool_spec</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">tool_spec</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> missing TOOL_SPEC (neither at module level nor as a decorated function)&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Standard local tool loading</span>
            <span class="n">tool_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">tool_func_name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> missing function </span><span class="si">{</span><span class="n">tool_func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">tool_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">tool_func_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_func</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> function is not callable&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">PythonAgentTool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">tool_func</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, sys_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load python tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentTool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a tool based on its file extension.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_path: Path to the tool file.</span>
<span class="sd">            tool_name: Name of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tool instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If the tool file does not exist.</span>
<span class="sd">            ValueError: If the tool file has an unsupported extension.</span>
<span class="sd">            Exception: For other errors during tool loading.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">abs_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool file not found: </span><span class="si">{</span><span class="n">abs_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_python_tool</span><span class="p">(</span><span class="n">abs_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported tool file type: </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_ext=&lt;</span><span class="si">%s</span><span class="s2">&gt;, cwd=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool&quot;</span><span class="p">,</span>
                <span class="n">tool_name</span><span class="p">,</span>
                <span class="n">abs_path</span><span class="p">,</span>
                <span class="n">ext</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="strands.tools.loader.ToolLoader.load_python_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_python_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#strands.tools.loader.ToolLoader.load_python_tool" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load a Python tool module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Python tool file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If required attributes are missing from the tool module.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there are issues importing the tool module.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool function is not callable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If function in module is not a valid tool.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For other errors during tool loading.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_python_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentTool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Python tool module.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_path: Path to the Python tool file.</span>
<span class="sd">        tool_name: Name of the tool.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tool instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If required attributes are missing from the tool module.</span>
<span class="sd">        ImportError: If there are issues importing the tool module.</span>
<span class="sd">        TypeError: If the tool function is not callable.</span>
<span class="sd">        ValueError: If function in module is not a valid tool.</span>
<span class="sd">        Exception: For other errors during tool loading.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if tool_path is in the format &quot;package.module:function&quot;; but keep in mind windows whose file path</span>
        <span class="c1"># could have a colon so also ensure that it&#39;s not a file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">tool_path</span><span class="p">:</span>
            <span class="n">module_path</span><span class="p">,</span> <span class="n">function_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | importing tool from path&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Import the module</span>
                <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span> <span class="n">fromlist</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">])</span>

                <span class="c1"># Get the function</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">function_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> has no function named </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">function_name</span><span class="p">)</span>

                <span class="c1"># Check if the function has a TOOL_SPEC (from @tool decorator)</span>
                <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found function-based tool&quot;</span><span class="p">,</span> <span class="n">function_name</span><span class="p">,</span> <span class="n">module_path</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Function </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2"> is not a valid tool (missing @tool decorator)&quot;</span>
                    <span class="p">)</span>

            <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to import module </span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="c1"># Normal file-based tool loading</span>
        <span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loading python tool from path&quot;</span><span class="p">,</span> <span class="n">abs_path</span><span class="p">)</span>

        <span class="c1"># First load the module to get TOOL_SPEC and check for Lambda deployment</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">abs_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not create spec for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No loader available for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="c1"># First, check for function-based tools with @tool decorator</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="c1"># Check if this is a function with TOOL_SPEC attached (from @tool decorator)</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found function-based tool in path&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">tool_path</span>
                <span class="p">)</span>
                <span class="c1"># Return as FunctionTool</span>
                <span class="k">return</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="c1"># If no function-based tools found, fall back to traditional module-level tool</span>
        <span class="n">tool_spec</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tool_spec</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> missing TOOL_SPEC (neither at module level nor as a decorated function)&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Standard local tool loading</span>
        <span class="n">tool_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">tool_func_name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> missing function </span><span class="si">{</span><span class="n">tool_func_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">tool_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">tool_func_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> function is not callable&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PythonAgentTool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">tool_func</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, sys_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load python tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.loader.ToolLoader.load_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#strands.tools.loader.ToolLoader.load_tool" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load a tool based on its file extension.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the tool file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool file does not exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool file has an unsupported extension.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For other errors during tool loading.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentTool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a tool based on its file extension.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_path: Path to the tool file.</span>
<span class="sd">        tool_name: Name of the tool.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tool instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the tool file does not exist.</span>
<span class="sd">        ValueError: If the tool file has an unsupported extension.</span>
<span class="sd">        Exception: For other errors during tool loading.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">abs_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool file not found: </span><span class="si">{</span><span class="n">abs_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_python_tool</span><span class="p">(</span><span class="n">abs_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported tool file type: </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_ext=&lt;</span><span class="si">%s</span><span class="s2">&gt;, cwd=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool&quot;</span><span class="p">,</span>
            <span class="n">tool_name</span><span class="p">,</span>
            <span class="n">abs_path</span><span class="p">,</span>
            <span class="n">ext</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="strands.tools.loader.load_function_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_function_tool</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#strands.tools.loader.load_function_tool" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load a function as a tool if it's decorated with @tool.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="FunctionTool (strands.tools.tools.FunctionTool)" href="#strands.tools.tools.FunctionTool">FunctionTool</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FunctionTool if successful, None otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_function_tool</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FunctionTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a function as a tool if it&#39;s decorated with @tool.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">        FunctionTool if successful, None otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load function tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.loader.scan_directory_for_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scan_directory_for_tools</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

<a href="#strands.tools.loader.scan_directory_for_tools" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Scan a directory for Python modules containing function-based tools.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to scan.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="FunctionTool (strands.tools.tools.FunctionTool)" href="#strands.tools.tools.FunctionTool">FunctionTool</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping tool names to FunctionTool instances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_directory_for_tools</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FunctionTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scan a directory for Python modules containing function-based tools.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory: The directory to scan.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary mapping tool names to FunctionTool instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tools</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FunctionTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">tools</span>

    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">directory</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.py&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Dynamically import the module</span>
            <span class="n">module_name</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">stem</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">spec</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

            <span class="c1"># Find tools in the module</span>
            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
                    <span class="n">tool</span> <span class="o">=</span> <span class="n">load_function_tool</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">tool</span><span class="p">:</span>
                        <span class="c1"># Use the tool&#39;s name from tool_name property (which includes custom names)</span>
                        <span class="n">tools</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tools under path | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tools</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="strands.tools.loader.scan_module_for_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">)</span></code>

<a href="#strands.tools.loader.scan_module_for_tools" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Scan a module for function-based tools.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The module to scan.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="FunctionTool (strands.tools.tools.FunctionTool)" href="#strands.tools.tools.FunctionTool">FunctionTool</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of FunctionTool instances found in the module.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">FunctionTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scan a module for function-based tools.</span>

<span class="sd">    Args:</span>
<span class="sd">        module: The module to scan.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of FunctionTool instances found in the module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tools</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">module</span><span class="p">):</span>
        <span class="c1"># Check if this is a function with TOOL_SPEC attached</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
            <span class="c1"># Create a function tool with correct name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tool</span> <span class="o">=</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">tools</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to create function tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tools</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.registry" class="doc doc-heading">
            <code>strands.tools.registry</code>


<a href="#strands.tools.registry" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Tool registry.</p>
<p>This module provides the central registry for all tools available to the agent, including discovery, validation, and
invocation capabilities.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.registry.ToolRegistry" class="doc doc-heading">
            <code>ToolRegistry</code>


<a href="#strands.tools.registry.ToolRegistry" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Central registry for all tools available to the agent.</p>
<p>This class manages tool registration, validation, discovery, and invocation.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/registry.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ToolRegistry</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Central registry for all tools available to the agent.</span>

<span class="sd">    This class manages tool registration, validation, discovery, and invocation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the tool registry.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process tools list that can contain tool names, paths, imported modules, or functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            tools: List of tool specifications.</span>
<span class="sd">                Can be:</span>

<span class="sd">                - String tool names (e.g., &quot;calculator&quot;)</span>
<span class="sd">                - File paths (e.g., &quot;/path/to/tool.py&quot;)</span>
<span class="sd">                - Imported Python modules (e.g., a module object)</span>
<span class="sd">                - Functions decorated with @tool</span>
<span class="sd">                - Dictionaries with name/path keys</span>
<span class="sd">                - Instance of an AgentTool</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of tool names that were processed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tool_names</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">:</span>
            <span class="c1"># Case 1: String file path</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Extract tool name from path</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">)</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

            <span class="c1"># Case 2: Dictionary with name and path</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">tool</span> <span class="ow">and</span> <span class="s2">&quot;path&quot;</span> <span class="ow">in</span> <span class="n">tool</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

            <span class="c1"># Case 3: Dictionary with path only</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;path&quot;</span> <span class="ow">in</span> <span class="n">tool</span><span class="p">:</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

            <span class="c1"># Case 4: Imported Python module</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;__file__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ismodule</span><span class="p">(</span><span class="n">tool</span><span class="p">):</span>
                <span class="c1"># Get the module file path</span>
                <span class="n">module_path</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__file__</span>
                <span class="c1"># Extract the tool name from the module name</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="c1"># Check for TOOL_SPEC in module to validate it&#39;s a Strands tool</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">module_path</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">module_path</span><span class="p">)</span>
                    <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                        <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">function_tools</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | invalid agent tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

            <span class="c1"># Case 5: Function decorated with @tool</span>
            <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">function_tool</span> <span class="o">=</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | registering function tool&quot;</span><span class="p">,</span> <span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                    <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to register function tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool=&lt;</span><span class="si">%s</span><span class="s2">&gt; | unrecognized tool specification&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tool_names</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_tool_from_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a tool from a file path.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_name: Name of the tool.</span>
<span class="sd">            tool_path: Path to the tool file.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If the tool file is not found.</span>
<span class="sd">            ValueError: If the tool cannot be loaded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.loader</span><span class="w"> </span><span class="kn">import</span> <span class="n">ToolLoader</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">tool_path</span> <span class="o">=</span> <span class="n">expanduser</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tool_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool file not found: </span><span class="si">{</span><span class="n">tool_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">loaded_tool</span> <span class="o">=</span> <span class="n">ToolLoader</span><span class="o">.</span><span class="n">load_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="n">loaded_tool</span><span class="o">.</span><span class="n">mark_dynamic</span><span class="p">()</span>

            <span class="c1"># Because we&#39;re explicitly registering the tool we don&#39;t need an allowlist</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">loaded_tool</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">exception_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exception_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_tools_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dynamically generate tool configuration by combining built-in and dynamic tools.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary containing all tool configurations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tool_config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;getting tool configurations&quot;</span><span class="p">)</span>

        <span class="c1"># Add all registered tools</span>
        <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Make a deep copy to avoid modifying the original</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Normalize the schema before validation</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">normalize_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">tool_config</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loaded tool config&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Add any dynamic tools</span>
        <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_config</span><span class="p">:</span>
                <span class="c1"># Make a deep copy to avoid modifying the original</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Normalize the schema before validation</span>
                    <span class="n">spec</span> <span class="o">=</span> <span class="n">normalize_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                    <span class="n">tool_config</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loaded dynamic tool config&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | dynamic tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_count=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tools configured&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_config</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">tool_config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">AgentTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a tool function with the given name.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool: The tool to register.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_type=&lt;</span><span class="si">%s</span><span class="s2">&gt;, is_dynamic=&lt;</span><span class="si">%s</span><span class="s2">&gt; | registering tool&quot;</span><span class="p">,</span>
            <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span>
            <span class="n">tool</span><span class="o">.</span><span class="n">tool_type</span><span class="p">,</span>
            <span class="n">tool</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Register in main registry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

        <span class="c1"># Register in dynamic tools if applicable</span>
        <span class="k">if</span> <span class="n">tool</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">tool</span><span class="o">.</span><span class="n">supports_hot_reload</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_type=&lt;</span><span class="si">%s</span><span class="s2">&gt; | skipping hot reloading&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_type</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_registry=&lt;</span><span class="si">%s</span><span class="s2">&gt;, dynamic_tools=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool registered&quot;</span><span class="p">,</span>
                <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_tools_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all tool directory paths.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of Path objects for current working directory&#39;s &quot;./tools/&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Current working directory&#39;s tools directory</span>
        <span class="n">cwd_tools_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;tools&quot;</span>

        <span class="c1"># Return all directories that exist</span>
        <span class="n">tool_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cwd_tools_dir</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">directory</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">tool_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found tools directory&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tools directory not found&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tool_dirs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">discover_tool_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Discover available tool modules in all tools directories.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary mapping tool names to their full paths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tool_modules</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | scanning&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>

            <span class="c1"># Find Python tools</span>
            <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tools_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">extension</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">):</span>
                        <span class="n">module_name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">stem</span>
                        <span class="c1"># If tool already exists, newer paths take precedence</span>
                        <span class="k">if</span> <span class="n">module_name</span> <span class="ow">in</span> <span class="n">tool_modules</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool overridden&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">,</span> <span class="n">module_name</span><span class="p">)</span>
                        <span class="n">tool_modules</span><span class="p">[</span><span class="n">module_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_modules=&lt;</span><span class="si">%s</span><span class="s2">&gt; | discovered&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">tool_modules</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">tool_modules</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reload_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reload a specific tool module.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_name: Name of the tool to reload.</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If the tool file cannot be found.</span>
<span class="sd">            ImportError: If there are issues importing the tool module.</span>
<span class="sd">            ValueError: If the tool specification is invalid or required components are missing.</span>
<span class="sd">            Exception: For other errors during tool reloading.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check for tool file</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | searching directories for tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>
            <span class="n">tool_path</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># Search for the tool file in all tool directories</span>
            <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
                <span class="n">temp_path</span> <span class="o">=</span> <span class="n">tools_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">.py&quot;</span>
                <span class="k">if</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">tool_path</span> <span class="o">=</span> <span class="n">temp_path</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">tool_path</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No tool file found for: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | reloading tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

            <span class="c1"># Add tool directory to path temporarily</span>
            <span class="n">tool_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tool_dir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Load the module directly using spec</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load spec for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">module</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

                <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

            <span class="k">finally</span><span class="p">:</span>
                <span class="c1"># Remove the temporary path</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_dir</span><span class="p">)</span>

            <span class="c1"># Look for function-based tools first</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">function_tools</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                        <span class="c1"># Register the function-based tool</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>

                        <span class="c1"># Update tool configuration if available</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_update_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="n">function_tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="p">})</span>

                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | successfully reloaded function-based tool from module&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                    <span class="k">return</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;function tool loader not available | falling back to traditional tools&quot;</span><span class="p">)</span>

            <span class="c1"># Fall back to traditional module-level tools</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> is missing TOOL_SPEC (neither at module level nor as a decorated function)&quot;</span>
                <span class="p">)</span>

            <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> is missing </span><span class="si">{</span><span class="n">expected_func_name</span><span class="si">}</span><span class="s2"> function&quot;</span><span class="p">)</span>

            <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> function is not callable&quot;</span><span class="p">)</span>

            <span class="c1"># Validate tool spec</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>

            <span class="n">new_tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
                <span class="n">tool_spec</span><span class="o">=</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Register the tool</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">new_tool</span><span class="p">)</span>

            <span class="c1"># Update tool configuration if available</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">})</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | successfully reloaded tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to reload tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load_tools_from_directory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize all tools by discovering and loading them dynamically from all tool directories.</span>

<span class="sd">        Args:</span>
<span class="sd">            load_tools_from_directory: Whether to reload tools if changes are made at runtime.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Then discover and load other tools</span>
        <span class="n">tool_modules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover_tool_modules</span><span class="p">()</span>
        <span class="n">successful_loads</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_tools</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_modules</span><span class="p">)</span>
        <span class="n">tool_import_errors</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Process Python tools</span>
        <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span> <span class="ow">in</span> <span class="n">tool_modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">load_tools_from_directory</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Add directory to path temporarily</span>
                <span class="n">tool_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tool_dir</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="k">finally</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">tool_dir</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_dir</span><span class="p">)</span>

                <span class="c1"># Process Python tool</span>
                <span class="k">if</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
                    <span class="c1"># Check for decorated function tools first</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">function_tools</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                                <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Fall back to traditional tools</span>
                            <span class="c1"># Check for expected tool function</span>
                            <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
                                <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
                                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                        <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function exists but is not callable&quot;</span><span class="p">,</span> <span class="n">tool_name</span>
                                    <span class="p">)</span>
                                    <span class="k">continue</span>

                                <span class="c1"># Validate tool spec before registering</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool is missing TOOL_SPEC | skipping&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                                    <span class="k">continue</span>

                                <span class="k">try</span><span class="p">:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                                    <span class="k">continue</span>

                                <span class="n">tool_spec</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span>
                                <span class="n">tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
                                    <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
                                    <span class="n">tool_spec</span><span class="o">=</span><span class="n">tool_spec</span><span class="p">,</span>
                                    <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
                                <span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                                <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function missing&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                        <span class="c1"># Function tool loader not available, fall back to traditional tools</span>
                        <span class="c1"># Check for expected tool function</span>
                        <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
                            <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function exists but is not callable&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="c1"># Validate tool spec before registering</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool is missing TOOL_SPEC | skipping&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
                            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="n">tool_spec</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span>
                            <span class="n">tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
                                <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
                                <span class="n">tool_spec</span><span class="o">=</span><span class="n">tool_spec</span><span class="p">,</span>
                                <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                            <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function missing&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="n">tool_import_errors</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="c1"># Log summary</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_count=&lt;</span><span class="si">%d</span><span class="s2">&gt;, success_count=&lt;</span><span class="si">%d</span><span class="s2">&gt; | finished loading tools&quot;</span><span class="p">,</span> <span class="n">total_tools</span><span class="p">,</span> <span class="n">successful_loads</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tool_import_errors</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">tool_import_errors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | import error | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize tool configuration from tool handler with optional filtering.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tool config.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_tools_config</span><span class="p">()</span>

        <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;toolSpec&quot;</span><span class="p">:</span> <span class="n">tool_spec</span><span class="p">}</span> <span class="k">for</span> <span class="n">tool_spec</span> <span class="ow">in</span> <span class="n">all_tools</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

        <span class="k">return</span> <span class="n">ToolConfig</span><span class="p">(</span>
            <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
            <span class="n">toolChoice</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="n">ToolChoice</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;auto&quot;</span><span class="p">:</span> <span class="n">ToolChoiceAuto</span><span class="p">()}),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_tool_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate tool specification against required schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_spec: Tool specification to validate.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specification is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">]</span>
        <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_spec</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required fields in tool spec: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_fields</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]:</span>
            <span class="c1"># Convert direct schema to proper format</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="n">normalize_schema</span><span class="p">(</span><span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">])</span>
            <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">}</span>
            <span class="k">return</span>

        <span class="c1"># Validate json schema fields</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">][</span><span class="s2">&quot;json&quot;</span><span class="p">]</span>

        <span class="c1"># Ensure schema has required fields</span>
        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;required&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Validate property definitions</span>
        <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_def</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_def</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Property </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_def</span><span class="p">:</span>
                <span class="n">prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;description&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_def</span><span class="p">:</span>
                <span class="n">prop_def</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Property </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">NewToolDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dictionary type for adding or updating a tool in the configuration.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            spec: The tool specification that defines the tool&#39;s interface and behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">spec</span><span class="p">:</span> <span class="n">ToolSpec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">new_tool</span><span class="p">:</span> <span class="n">NewToolDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update tool configuration with a new tool.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_config: The current tool configuration dictionary.</span>
<span class="sd">            new_tool: The new tool to add/update.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the new tool spec is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_tool</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spec&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid tool format - missing spec&quot;</span><span class="p">)</span>

        <span class="c1"># Validate tool spec before updating</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">new_tool</span><span class="p">[</span><span class="s2">&quot;spec&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool specification validation failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="n">new_tool_name</span> <span class="o">=</span> <span class="n">new_tool</span><span class="p">[</span><span class="s2">&quot;spec&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">existing_tool_idx</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Find if tool already exists</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tool_entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tool_config</span><span class="p">[</span><span class="s2">&quot;tools&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">tool_entry</span><span class="p">[</span><span class="s2">&quot;toolSpec&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_tool_name</span><span class="p">:</span>
                <span class="n">existing_tool_idx</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="k">break</span>

        <span class="c1"># Update existing tool or add new one</span>
        <span class="n">new_tool_entry</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;toolSpec&quot;</span><span class="p">:</span> <span class="n">new_tool</span><span class="p">[</span><span class="s2">&quot;spec&quot;</span><span class="p">]}</span>
        <span class="k">if</span> <span class="n">existing_tool_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tool_config</span><span class="p">[</span><span class="s2">&quot;tools&quot;</span><span class="p">][</span><span class="n">existing_tool_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_tool_entry</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | updated existing tool&quot;</span><span class="p">,</span> <span class="n">new_tool_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tool_config</span><span class="p">[</span><span class="s2">&quot;tools&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_tool_entry</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | added new tool&quot;</span><span class="p">,</span> <span class="n">new_tool_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="strands.tools.registry.ToolRegistry.NewToolDict" class="doc doc-heading">
            <code>NewToolDict</code>


<a href="#strands.tools.registry.ToolRegistry.NewToolDict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing_extensions.TypedDict">TypedDict</span></code></p>


        <p>Dictionary type for adding or updating a tool in the configuration.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="strands.tools.registry.ToolRegistry.NewToolDict.spec">spec</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool specification that defines the tool's interface and behavior.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>strands/tools/registry.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NewToolDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary type for adding or updating a tool in the configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        spec: The tool specification that defines the tool&#39;s interface and behavior.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">spec</span><span class="p">:</span> <span class="n">ToolSpec</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#strands.tools.registry.ToolRegistry.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the tool registry.</p>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the tool registry.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.discover_tool_modules" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discover_tool_modules</span><span class="p">()</span></code>

<a href="#strands.tools.registry.ToolRegistry.discover_tool_modules" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Discover available tool modules in all tools directories.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping tool names to their full paths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discover_tool_modules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Discover available tool modules in all tools directories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary mapping tool names to their full paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tool_modules</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | scanning&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>

        <span class="c1"># Find Python tools</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">tools_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">extension</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">):</span>
                    <span class="n">module_name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">stem</span>
                    <span class="c1"># If tool already exists, newer paths take precedence</span>
                    <span class="k">if</span> <span class="n">module_name</span> <span class="ow">in</span> <span class="n">tool_modules</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool overridden&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">,</span> <span class="n">module_name</span><span class="p">)</span>
                    <span class="n">tool_modules</span><span class="p">[</span><span class="n">module_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_modules=&lt;</span><span class="si">%s</span><span class="s2">&gt; | discovered&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">tool_modules</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">tool_modules</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.get_all_tools_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_tools_config</span><span class="p">()</span></code>

<a href="#strands.tools.registry.ToolRegistry.get_all_tools_config" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Dynamically generate tool configuration by combining built-in and dynamic tools.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing all tool configurations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_tools_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dynamically generate tool configuration by combining built-in and dynamic tools.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing all tool configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tool_config</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;getting tool configurations&quot;</span><span class="p">)</span>

    <span class="c1"># Add all registered tools</span>
    <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Make a deep copy to avoid modifying the original</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Normalize the schema before validation</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">normalize_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="n">tool_config</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loaded tool config&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="c1"># Add any dynamic tools</span>
    <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_config</span><span class="p">:</span>
            <span class="c1"># Make a deep copy to avoid modifying the original</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Normalize the schema before validation</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">normalize_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
                <span class="n">tool_config</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | loaded dynamic tool config&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | dynamic tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_count=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tools configured&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_config</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tool_config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.get_tools_dirs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tools_dirs</span><span class="p">()</span></code>

<a href="#strands.tools.registry.ToolRegistry.get_tools_dirs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get all tool directory paths.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of Path objects for current working directory's "./tools/".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_tools_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all tool directory paths.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of Path objects for current working directory&#39;s &quot;./tools/&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Current working directory&#39;s tools directory</span>
    <span class="n">cwd_tools_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;tools&quot;</span>

    <span class="c1"># Return all directories that exist</span>
    <span class="n">tool_dirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cwd_tools_dir</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">directory</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">tool_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | found tools directory&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tools directory not found&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tool_dirs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.initialize_tool_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_tool_config</span><span class="p">()</span></code>

<a href="#strands.tools.registry.ToolRegistry.initialize_tool_config" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize tool configuration from tool handler with optional filtering.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolConfig (strands.types.tools.ToolConfig)" href="../types/#strands.types.tools.ToolConfig">ToolConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool config.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize tool configuration from tool handler with optional filtering.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tool config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_tools</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_tools_config</span><span class="p">()</span>

    <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;toolSpec&quot;</span><span class="p">:</span> <span class="n">tool_spec</span><span class="p">}</span> <span class="k">for</span> <span class="n">tool_spec</span> <span class="ow">in</span> <span class="n">all_tools</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

    <span class="k">return</span> <span class="n">ToolConfig</span><span class="p">(</span>
        <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
        <span class="n">toolChoice</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="n">ToolChoice</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;auto&quot;</span><span class="p">:</span> <span class="n">ToolChoiceAuto</span><span class="p">()}),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.initialize_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_tools</span><span class="p">(</span><span class="n">load_tools_from_directory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.initialize_tools" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize all tools by discovering and loading them dynamically from all tool directories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>load_tools_from_directory</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to reload tools if changes are made at runtime.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load_tools_from_directory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize all tools by discovering and loading them dynamically from all tool directories.</span>

<span class="sd">    Args:</span>
<span class="sd">        load_tools_from_directory: Whether to reload tools if changes are made at runtime.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Then discover and load other tools</span>
    <span class="n">tool_modules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover_tool_modules</span><span class="p">()</span>
    <span class="n">successful_loads</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">total_tools</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tool_modules</span><span class="p">)</span>
    <span class="n">tool_import_errors</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Process Python tools</span>
    <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span> <span class="ow">in</span> <span class="n">tool_modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">load_tools_from_directory</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Add directory to path temporarily</span>
            <span class="n">tool_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tool_dir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tool_dir</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_dir</span><span class="p">)</span>

            <span class="c1"># Process Python tool</span>
            <span class="k">if</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
                <span class="c1"># Check for decorated function tools first</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">function_tools</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                            <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Fall back to traditional tools</span>
                        <span class="c1"># Check for expected tool function</span>
                        <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
                            <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                    <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function exists but is not callable&quot;</span><span class="p">,</span> <span class="n">tool_name</span>
                                <span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="c1"># Validate tool spec before registering</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool is missing TOOL_SPEC | skipping&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
                            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                                <span class="k">continue</span>

                            <span class="n">tool_spec</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span>
                            <span class="n">tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
                                <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
                                <span class="n">tool_spec</span><span class="o">=</span><span class="n">tool_spec</span><span class="p">,</span>
                                <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                            <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function missing&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                    <span class="c1"># Function tool loader not available, fall back to traditional tools</span>
                    <span class="c1"># Check for expected tool function</span>
                    <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
                        <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function exists but is not callable&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                            <span class="k">continue</span>

                        <span class="c1"># Validate tool spec before registering</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool is missing TOOL_SPEC | skipping&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                            <span class="k">continue</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool spec validation failed | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                            <span class="k">continue</span>

                        <span class="n">tool_spec</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span>
                        <span class="n">tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
                            <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
                            <span class="n">tool_spec</span><span class="o">=</span><span class="n">tool_spec</span><span class="p">,</span>
                            <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                        <span class="n">successful_loads</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool function missing&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">tool_import_errors</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="c1"># Log summary</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_count=&lt;</span><span class="si">%d</span><span class="s2">&gt;, success_count=&lt;</span><span class="si">%d</span><span class="s2">&gt; | finished loading tools&quot;</span><span class="p">,</span> <span class="n">total_tools</span><span class="p">,</span> <span class="n">successful_loads</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tool_import_errors</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">tool_import_errors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | import error | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.load_tool_from_filepath" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.load_tool_from_filepath" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load a tool from a file path.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the tool file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool file is not found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool cannot be loaded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_tool_from_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a tool from a file path.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_name: Name of the tool.</span>
<span class="sd">        tool_path: Path to the tool file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the tool file is not found.</span>
<span class="sd">        ValueError: If the tool cannot be loaded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.loader</span><span class="w"> </span><span class="kn">import</span> <span class="n">ToolLoader</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">tool_path</span> <span class="o">=</span> <span class="n">expanduser</span><span class="p">(</span><span class="n">tool_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tool_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool file not found: </span><span class="si">{</span><span class="n">tool_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">loaded_tool</span> <span class="o">=</span> <span class="n">ToolLoader</span><span class="o">.</span><span class="n">load_tool</span><span class="p">(</span><span class="n">tool_path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="n">loaded_tool</span><span class="o">.</span><span class="n">mark_dynamic</span><span class="p">()</span>

        <span class="c1"># Because we&#39;re explicitly registering the tool we don&#39;t need an allowlist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">loaded_tool</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">exception_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to load tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exception_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.process_tools" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_tools</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.process_tools" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Process tools list that can contain tool names, paths, imported modules, or functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tools</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tool specifications.
Can be:</p>
<ul>
<li>String tool names (e.g., "calculator")</li>
<li>File paths (e.g., "/path/to/tool.py")</li>
<li>Imported Python modules (e.g., a module object)</li>
<li>Functions decorated with @tool</li>
<li>Dictionaries with name/path keys</li>
<li>Instance of an AgentTool</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tool names that were processed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process tools list that can contain tool names, paths, imported modules, or functions.</span>

<span class="sd">    Args:</span>
<span class="sd">        tools: List of tool specifications.</span>
<span class="sd">            Can be:</span>

<span class="sd">            - String tool names (e.g., &quot;calculator&quot;)</span>
<span class="sd">            - File paths (e.g., &quot;/path/to/tool.py&quot;)</span>
<span class="sd">            - Imported Python modules (e.g., a module object)</span>
<span class="sd">            - Functions decorated with @tool</span>
<span class="sd">            - Dictionaries with name/path keys</span>
<span class="sd">            - Instance of an AgentTool</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of tool names that were processed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tool_names</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">:</span>
        <span class="c1"># Case 1: String file path</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Extract tool name from path</span>
            <span class="n">tool_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">)</span>
            <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

        <span class="c1"># Case 2: Dictionary with name and path</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">tool</span> <span class="ow">and</span> <span class="s2">&quot;path&quot;</span> <span class="ow">in</span> <span class="n">tool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
            <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>

        <span class="c1"># Case 3: Dictionary with path only</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;path&quot;</span> <span class="ow">in</span> <span class="n">tool</span><span class="p">:</span>
            <span class="n">tool_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
            <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>

        <span class="c1"># Case 4: Imported Python module</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;__file__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ismodule</span><span class="p">(</span><span class="n">tool</span><span class="p">):</span>
            <span class="c1"># Get the module file path</span>
            <span class="n">module_path</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__file__</span>
            <span class="c1"># Extract the tool name from the module name</span>
            <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Check for TOOL_SPEC in module to validate it&#39;s a Strands tool</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">module_path</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">load_tool_from_filepath</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool_path</span><span class="o">=</span><span class="n">module_path</span><span class="p">)</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                    <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">function_tools</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, module_path=&lt;</span><span class="si">%s</span><span class="s2">&gt; | invalid agent tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">module_path</span><span class="p">)</span>

        <span class="c1"># Case 5: Function decorated with @tool</span>
        <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">function_tool</span> <span class="o">=</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | registering function tool&quot;</span><span class="p">,</span> <span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>
                <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to register function tool | </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="n">AgentTool</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
            <span class="n">tool_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool=&lt;</span><span class="si">%s</span><span class="s2">&gt; | unrecognized tool specification&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tool_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.register_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.register_tool" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Register a tool function with the given name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool to register.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">AgentTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a tool function with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool: The tool to register.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_type=&lt;</span><span class="si">%s</span><span class="s2">&gt;, is_dynamic=&lt;</span><span class="si">%s</span><span class="s2">&gt; | registering tool&quot;</span><span class="p">,</span>
        <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span>
        <span class="n">tool</span><span class="o">.</span><span class="n">tool_type</span><span class="p">,</span>
        <span class="n">tool</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Register in main registry</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

    <span class="c1"># Register in dynamic tools if applicable</span>
    <span class="k">if</span> <span class="n">tool</span><span class="o">.</span><span class="n">is_dynamic</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tool</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">tool</span><span class="o">.</span><span class="n">supports_hot_reload</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_type=&lt;</span><span class="si">%s</span><span class="s2">&gt; | skipping hot reloading&quot;</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_type</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, tool_registry=&lt;</span><span class="si">%s</span><span class="s2">&gt;, dynamic_tools=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool registered&quot;</span><span class="p">,</span>
            <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_tools</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.reload_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reload_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.reload_tool" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Reload a specific tool module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool to reload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool file cannot be found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there are issues importing the tool module.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the tool specification is invalid or required components are missing.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For other errors during tool reloading.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reload_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reload a specific tool module.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_name: Name of the tool to reload.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the tool file cannot be found.</span>
<span class="sd">        ImportError: If there are issues importing the tool module.</span>
<span class="sd">        ValueError: If the tool specification is invalid or required components are missing.</span>
<span class="sd">        Exception: For other errors during tool reloading.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check for tool file</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | searching directories for tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>
        <span class="n">tool_path</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Search for the tool file in all tool directories</span>
        <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
            <span class="n">temp_path</span> <span class="o">=</span> <span class="n">tools_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">.py&quot;</span>
            <span class="k">if</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">tool_path</span> <span class="o">=</span> <span class="n">temp_path</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">tool_path</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No tool file found for: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | reloading tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

        <span class="c1"># Add tool directory to path temporarily</span>
        <span class="n">tool_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tool_dir</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Load the module directly using spec</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">spec_from_file_location</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool_path</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load spec for </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">module</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">module_from_spec</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span>

            <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">loader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not load </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">spec</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Remove the temporary path</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tool_dir</span><span class="p">)</span>

        <span class="c1"># Look for function-based tools first</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">function_tools</span> <span class="o">=</span> <span class="n">scan_module_for_tools</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">function_tools</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">function_tool</span> <span class="ow">in</span> <span class="n">function_tools</span><span class="p">:</span>
                    <span class="c1"># Register the function-based tool</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">function_tool</span><span class="p">)</span>

                    <span class="c1"># Update tool configuration if available</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_update_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="n">function_tool</span><span class="o">.</span><span class="n">tool_spec</span><span class="p">})</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | successfully reloaded function-based tool from module&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;function tool loader not available | falling back to traditional tools&quot;</span><span class="p">)</span>

        <span class="c1"># Fall back to traditional module-level tools</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;TOOL_SPEC&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> is missing TOOL_SPEC (neither at module level nor as a decorated function)&quot;</span>
            <span class="p">)</span>

        <span class="n">expected_func_name</span> <span class="o">=</span> <span class="n">tool_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> is missing </span><span class="si">{</span><span class="n">expected_func_name</span><span class="si">}</span><span class="s2"> function&quot;</span><span class="p">)</span>

        <span class="n">tool_function</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">expected_func_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">tool_function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2"> function is not callable&quot;</span><span class="p">)</span>

        <span class="c1"># Validate tool spec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">)</span>

        <span class="n">new_tool</span> <span class="o">=</span> <span class="n">PythonAgentTool</span><span class="p">(</span>
            <span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">,</span>
            <span class="n">tool_spec</span><span class="o">=</span><span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="n">tool_function</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Register the tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">new_tool</span><span class="p">)</span>

        <span class="c1"># Update tool configuration if available</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_tool_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_config</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="n">module</span><span class="o">.</span><span class="n">TOOL_SPEC</span><span class="p">})</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | successfully reloaded tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to reload tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.registry.ToolRegistry.validate_tool_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_tool_spec</span><span class="p">(</span><span class="n">tool_spec</span><span class="p">)</span></code>

<a href="#strands.tools.registry.ToolRegistry.validate_tool_spec" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Validate tool specification against required schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_spec</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tool specification to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specification is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_tool_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_spec</span><span class="p">:</span> <span class="n">ToolSpec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate tool specification against required schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_spec: Tool specification to validate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specification is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">]</span>
    <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_spec</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required fields in tool spec: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_fields</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]:</span>
        <span class="c1"># Convert direct schema to proper format</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="n">normalize_schema</span><span class="p">(</span><span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">])</span>
        <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">}</span>
        <span class="k">return</span>

    <span class="c1"># Validate json schema fields</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="n">tool_spec</span><span class="p">[</span><span class="s2">&quot;inputSchema&quot;</span><span class="p">][</span><span class="s2">&quot;json&quot;</span><span class="p">]</span>

    <span class="c1"># Ensure schema has required fields</span>
    <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s2">&quot;required&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Validate property definitions</span>
    <span class="k">for</span> <span class="n">prop_name</span><span class="p">,</span> <span class="n">prop_def</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_def</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">][</span><span class="n">prop_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Property </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_def</span><span class="p">:</span>
            <span class="n">prop_def</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;description&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">prop_def</span><span class="p">:</span>
            <span class="n">prop_def</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Property </span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.thread_pool_executor" class="doc doc-heading">
            <code>strands.tools.thread_pool_executor</code>


<a href="#strands.tools.thread_pool_executor" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Thread pool execution management for parallel tool calls.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper" class="doc doc-heading">
            <code>ThreadPoolExecutorWrapper</code>


<a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ParallelToolExecutorInterface (strands.types.event_loop.ParallelToolExecutorInterface)" href="../types/#strands.types.event_loop.ParallelToolExecutorInterface">ParallelToolExecutorInterface</a></code></p>


        <p>Wrapper around ThreadPoolExecutor to implement the strands.types.event_loop.ParallelToolExecutorInterface.</p>
<p>This class adapts Python's standard ThreadPoolExecutor to conform to the SDK's ParallelToolExecutorInterface,
allowing it to be used for parallel tool execution within the agent event loop. It provides methods for submitting
tasks, monitoring their completion, and shutting down the executor.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.thread_pool">thread_pool</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The underlying ThreadPoolExecutor instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>strands/tools/thread_pool_executor.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ThreadPoolExecutorWrapper</span><span class="p">(</span><span class="n">ParallelToolExecutorInterface</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper around ThreadPoolExecutor to implement the strands.types.event_loop.ParallelToolExecutorInterface.</span>

<span class="sd">    This class adapts Python&#39;s standard ThreadPoolExecutor to conform to the SDK&#39;s ParallelToolExecutorInterface,</span>
<span class="sd">    allowing it to be used for parallel tool execution within the agent event loop. It provides methods for submitting</span>
<span class="sd">    tasks, monitoring their completion, and shutting down the executor.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        thread_pool: The underlying ThreadPoolExecutor instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thread_pool</span><span class="p">:</span> <span class="n">ThreadPoolExecutor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize with a ThreadPoolExecutor instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            thread_pool: The ThreadPoolExecutor to wrap.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span> <span class="o">=</span> <span class="n">thread_pool</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Future</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Submit a callable to be executed with the given arguments.</span>

<span class="sd">        This method schedules the callable to be executed as fn(*args, **kwargs)</span>
<span class="sd">        and returns a Future instance representing the execution of the callable.</span>

<span class="sd">        Args:</span>
<span class="sd">            fn: The callable to execute.</span>
<span class="sd">            *args: Positional arguments for the callable.</span>
<span class="sd">            **kwargs: Keyword arguments for the callable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Future instance representing the execution of the callable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">as_completed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">futures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Future</span><span class="p">],</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Future</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an iterator over the futures as they complete.</span>

<span class="sd">        The returned iterator yields futures as they complete (finished or cancelled).</span>

<span class="sd">        Args:</span>
<span class="sd">            futures: The futures to iterate over.</span>
<span class="sd">            timeout: The maximum number of seconds to wait.</span>
<span class="sd">                None means no limit.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator yielding futures as they complete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            concurrent.futures.TimeoutError: If the timeout is reached.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>  <span class="c1"># type: ignore</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shutdown the thread pool executor.</span>

<span class="sd">        Args:</span>
<span class="sd">            wait: If True, waits until all running futures have finished executing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">thread_pool</span><span class="p">)</span></code>

<a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize with a ThreadPoolExecutor instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>thread_pool</code>
            </td>
            <td>
                  <code><span title="concurrent.futures.ThreadPoolExecutor">ThreadPoolExecutor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ThreadPoolExecutor to wrap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/thread_pool_executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thread_pool</span><span class="p">:</span> <span class="n">ThreadPoolExecutor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize with a ThreadPoolExecutor instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        thread_pool: The ThreadPoolExecutor to wrap.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span> <span class="o">=</span> <span class="n">thread_pool</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.as_completed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.as_completed" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return an iterator over the futures as they complete.</p>
<p>The returned iterator yields futures as they complete (finished or cancelled).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>futures</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="Future (strands.types.event_loop.Future)" href="../types/#strands.types.event_loop.Future">Future</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The futures to iterate over.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of seconds to wait.
None means no limit.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="Future (strands.types.event_loop.Future)" href="../types/#strands.types.event_loop.Future">Future</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterator yielding futures as they complete.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="concurrent.futures.TimeoutError">TimeoutError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the timeout is reached.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/thread_pool_executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">as_completed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">futures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Future</span><span class="p">],</span> <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Future</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an iterator over the futures as they complete.</span>

<span class="sd">    The returned iterator yields futures as they complete (finished or cancelled).</span>

<span class="sd">    Args:</span>
<span class="sd">        futures: The futures to iterate over.</span>
<span class="sd">        timeout: The maximum number of seconds to wait.</span>
<span class="sd">            None means no limit.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An iterator yielding futures as they complete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        concurrent.futures.TimeoutError: If the timeout is reached.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.shutdown" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shutdown</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.shutdown" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Shutdown the thread pool executor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>wait</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, waits until all running futures have finished executing.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/thread_pool_executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shutdown the thread pool executor.</span>

<span class="sd">    Args:</span>
<span class="sd">        wait: If True, waits until all running futures have finished executing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.submit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#strands.tools.thread_pool_executor.ThreadPoolExecutorWrapper.submit" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Submit a callable to be executed with the given arguments.</p>
<p>This method schedules the callable to be executed as fn(<em>args, </em>*kwargs)
and returns a Future instance representing the execution of the callable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callable to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments for the callable.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments for the callable.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Future (strands.types.event_loop.Future)" href="../types/#strands.types.event_loop.Future">Future</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Future instance representing the execution of the callable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/thread_pool_executor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Future</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Submit a callable to be executed with the given arguments.</span>

<span class="sd">    This method schedules the callable to be executed as fn(*args, **kwargs)</span>
<span class="sd">    and returns a Future instance representing the execution of the callable.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn: The callable to execute.</span>
<span class="sd">        *args: Positional arguments for the callable.</span>
<span class="sd">        **kwargs: Keyword arguments for the callable.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Future instance representing the execution of the callable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thread_pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.watcher" class="doc doc-heading">
            <code>strands.tools.watcher</code>


<a href="#strands.tools.watcher" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Tool watcher for hot reloading tools during development.</p>
<p>This module provides functionality to watch tool directories for changes and automatically reload tools when they are
modified.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="strands.tools.watcher.ToolWatcher" class="doc doc-heading">
            <code>ToolWatcher</code>


<a href="#strands.tools.watcher.ToolWatcher" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">


        <p>Watches tool directories for changes and reloads tools when they are modified.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ToolWatcher</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Watches tool directories for changes and reloads tools when they are modified.&quot;&quot;&quot;</span>

    <span class="c1"># This class uses class variables for the observer and handlers because watchdog allows only one Observer instance</span>
    <span class="c1"># per directory. Using class variables ensures that all ToolWatcher instances share a single Observer, with the</span>
    <span class="c1"># MasterChangeHandler routing file system events to the appropriate individual handlers for each registry. This</span>
    <span class="c1"># design pattern avoids conflicts when multiple tool registries are watching the same directories.</span>

    <span class="n">_shared_observer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_watched_dirs</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">_observer_started</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_registry_handlers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;ToolWatcher.ToolChangeHandler&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_registry</span><span class="p">:</span> <span class="n">ToolRegistry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a tool watcher for the given tool registry.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_registry: The tool registry to report changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span> <span class="o">=</span> <span class="n">tool_registry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">ToolChangeHandler</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handler for tool file changes.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_registry</span><span class="p">:</span> <span class="n">ToolRegistry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Initialize a tool change handler.</span>

<span class="sd">            Args:</span>
<span class="sd">                tool_registry: The tool registry to update when tools change.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span> <span class="o">=</span> <span class="n">tool_registry</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Reload tool if file modification detected.</span>

<span class="sd">            Args:</span>
<span class="sd">                event: The file system event that triggered this handler.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
                <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

                <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool change detected&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="o">.</span><span class="n">reload_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to reload tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">MasterChangeHandler</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Master handler that delegates to all registered handlers.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Initialize a master change handler for a specific directory.</span>

<span class="sd">            Args:</span>
<span class="sd">                dir_path: The directory path to watch.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span> <span class="o">=</span> <span class="n">dir_path</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Delegate file modification events to all registered handlers.</span>

<span class="sd">            Args:</span>
<span class="sd">                event: The file system event that triggered this handler.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
                <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
                <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

                <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
                    <span class="c1"># Delegate to all registered handlers for this directory</span>
                    <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">handler</span><span class="o">.</span><span class="n">on_modified</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | handler error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start watching all tools directories for changes.&quot;&quot;&quot;</span>
        <span class="c1"># Initialize shared observer if not already done</span>
        <span class="k">if</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>

        <span class="c1"># Create handler for this instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_change_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ToolChangeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="p">)</span>
        <span class="n">registry_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="p">)</span>

        <span class="c1"># Get tools directories to watch</span>
        <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
            <span class="n">dir_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tools_dir</span><span class="p">)</span>

            <span class="c1"># Initialize the registry handlers dict for this directory if needed</span>
            <span class="k">if</span> <span class="n">dir_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">:</span>
                <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">[</span><span class="n">dir_str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># Store this handler with its registry id</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">[</span><span class="n">dir_str</span><span class="p">][</span><span class="n">registry_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_change_handler</span>

            <span class="c1"># Schedule or update the master handler for this directory</span>
            <span class="k">if</span> <span class="n">dir_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_watched_dirs</span><span class="p">:</span>
                <span class="c1"># First time seeing this directory, create a master handler</span>
                <span class="n">master_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MasterChangeHandler</span><span class="p">(</span><span class="n">dir_str</span><span class="p">)</span>
                <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">master_handler</span><span class="p">,</span> <span class="n">dir_str</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_watched_dirs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">dir_str</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | started watching tools directory&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Directory already being watched, just log it</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | directory already being watched&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>

        <span class="c1"># Start the observer if not already started</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_observer_started</span><span class="p">:</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_observer_started</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool directory watching initialized&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="strands.tools.watcher.ToolWatcher.MasterChangeHandler" class="doc doc-heading">
            <code>MasterChangeHandler</code>


<a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="watchdog.events.FileSystemEventHandler">FileSystemEventHandler</span></code></p>


        <p>Master handler that delegates to all registered handlers.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MasterChangeHandler</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Master handler that delegates to all registered handlers.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a master change handler for a specific directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            dir_path: The directory path to watch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span> <span class="o">=</span> <span class="n">dir_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegate file modification events to all registered handlers.</span>

<span class="sd">        Args:</span>
<span class="sd">            event: The file system event that triggered this handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
            <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
            <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

            <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
                <span class="c1"># Delegate to all registered handlers for this directory</span>
                <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">handler</span><span class="o">.</span><span class="n">on_modified</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | handler error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="strands.tools.watcher.ToolWatcher.MasterChangeHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span></code>

<a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Initialize a master change handler for a specific directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory path to watch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a master change handler for a specific directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        dir_path: The directory path to watch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span> <span class="o">=</span> <span class="n">dir_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.watcher.ToolWatcher.MasterChangeHandler.on_modified" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_modified</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#strands.tools.watcher.ToolWatcher.MasterChangeHandler.on_modified" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Delegate file modification events to all registered handlers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>event</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file system event that triggered this handler.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delegate file modification events to all registered handlers.</span>

<span class="sd">    Args:</span>
<span class="sd">        event: The file system event that triggered this handler.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
        <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
        <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
            <span class="c1"># Delegate to all registered handlers for this directory</span>
            <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">handler</span><span class="o">.</span><span class="n">on_modified</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | handler error&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="strands.tools.watcher.ToolWatcher.ToolChangeHandler" class="doc doc-heading">
            <code>ToolChangeHandler</code>


<a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="watchdog.events.FileSystemEventHandler">FileSystemEventHandler</span></code></p>


        <p>Handler for tool file changes.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ToolChangeHandler</span><span class="p">(</span><span class="n">FileSystemEventHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler for tool file changes.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_registry</span><span class="p">:</span> <span class="n">ToolRegistry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a tool change handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_registry: The tool registry to update when tools change.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span> <span class="o">=</span> <span class="n">tool_registry</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reload tool if file modification detected.</span>

<span class="sd">        Args:</span>
<span class="sd">            event: The file system event that triggered this handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
            <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
            <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

            <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool change detected&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="o">.</span><span class="n">reload_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to reload tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="strands.tools.watcher.ToolWatcher.ToolChangeHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tool_registry</span><span class="p">)</span></code>

<a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Initialize a tool change handler.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_registry</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolRegistry (strands.tools.registry.ToolRegistry)" href="#strands.tools.registry.ToolRegistry">ToolRegistry</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool registry to update when tools change.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_registry</span><span class="p">:</span> <span class="n">ToolRegistry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a tool change handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_registry: The tool registry to update when tools change.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span> <span class="o">=</span> <span class="n">tool_registry</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.watcher.ToolWatcher.ToolChangeHandler.on_modified" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_modified</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#strands.tools.watcher.ToolWatcher.ToolChangeHandler.on_modified" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Reload tool if file modification detected.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>event</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file system event that triggered this handler.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reload tool if file modification detected.</span>

<span class="sd">    Args:</span>
<span class="sd">        event: The file system event that triggered this handler.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">):</span>
        <span class="n">tool_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">src_path</span><span class="p">)</span>
        <span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool_path</span><span class="o">.</span><span class="n">stem</span>

        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;__init__&quot;</span><span class="p">]:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | tool change detected&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="o">.</span><span class="n">reload_tool</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt;, exception=&lt;</span><span class="si">%s</span><span class="s2">&gt; | failed to reload tool&quot;</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="strands.tools.watcher.ToolWatcher.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tool_registry</span><span class="p">)</span></code>

<a href="#strands.tools.watcher.ToolWatcher.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a tool watcher for the given tool registry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_registry</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolRegistry (strands.tools.registry.ToolRegistry)" href="#strands.tools.registry.ToolRegistry">ToolRegistry</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool registry to report changes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_registry</span><span class="p">:</span> <span class="n">ToolRegistry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a tool watcher for the given tool registry.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_registry: The tool registry to report changes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span> <span class="o">=</span> <span class="n">tool_registry</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="strands.tools.watcher.ToolWatcher.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#strands.tools.watcher.ToolWatcher.start" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Start watching all tools directories for changes.</p>


            <details class="quote">
              <summary>Source code in <code>strands/tools/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start watching all tools directories for changes.&quot;&quot;&quot;</span>
    <span class="c1"># Initialize shared observer if not already done</span>
    <span class="k">if</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">()</span>

    <span class="c1"># Create handler for this instance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tool_change_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ToolChangeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="p">)</span>
    <span class="n">registry_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="p">)</span>

    <span class="c1"># Get tools directories to watch</span>
    <span class="n">tools_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_registry</span><span class="o">.</span><span class="n">get_tools_dirs</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">tools_dir</span> <span class="ow">in</span> <span class="n">tools_dirs</span><span class="p">:</span>
        <span class="n">dir_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tools_dir</span><span class="p">)</span>

        <span class="c1"># Initialize the registry handlers dict for this directory if needed</span>
        <span class="k">if</span> <span class="n">dir_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">:</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">[</span><span class="n">dir_str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Store this handler with its registry id</span>
        <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_registry_handlers</span><span class="p">[</span><span class="n">dir_str</span><span class="p">][</span><span class="n">registry_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_change_handler</span>

        <span class="c1"># Schedule or update the master handler for this directory</span>
        <span class="k">if</span> <span class="n">dir_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_watched_dirs</span><span class="p">:</span>
            <span class="c1"># First time seeing this directory, create a master handler</span>
            <span class="n">master_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MasterChangeHandler</span><span class="p">(</span><span class="n">dir_str</span><span class="p">)</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span><span class="o">.</span><span class="n">schedule</span><span class="p">(</span><span class="n">master_handler</span><span class="p">,</span> <span class="n">dir_str</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_watched_dirs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">dir_str</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | started watching tools directory&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Directory already being watched, just log it</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tools_dir=&lt;</span><span class="si">%s</span><span class="s2">&gt; | directory already being watched&quot;</span><span class="p">,</span> <span class="n">tools_dir</span><span class="p">)</span>

    <span class="c1"># Start the observer if not already started</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_observer_started</span><span class="p">:</span>
        <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_shared_observer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">ToolWatcher</span><span class="o">.</span><span class="n">_observer_started</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool directory watching initialized&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="strands.tools.mcp" class="doc doc-heading">
            <code>strands.tools.mcp</code>


<a href="#strands.tools.mcp" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Model Context Protocol (MCP) integration.</p>
<p>This package provides integration with the Model Context Protocol (MCP), allowing agents to use tools provided by MCP
servers.</p>
<ul>
<li>Docs: https://www.anthropic.com/news/model-context-protocol</li>
</ul>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="strands.tools.mcp.mcp_agent_tool" class="doc doc-heading">
            <code>strands.tools.mcp.mcp_agent_tool</code>


<a href="#strands.tools.mcp.mcp_agent_tool" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>MCP Agent Tool module for adapting Model Context Protocol tools to the agent framework.</p>
<p>This module provides the MCPAgentTool class which serves as an adapter between
MCP (Model Context Protocol) tools and the agent framework's tool interface.
It allows MCP tools to be seamlessly integrated and used within the agent ecosystem.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool" class="doc doc-heading">
            <code>MCPAgentTool</code>


<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AgentTool (strands.types.tools.AgentTool)" href="../types/#strands.types.tools.AgentTool">AgentTool</a></code></p>


        <p>Adapter class that wraps an MCP tool and exposes it as an AgentTool.</p>
<p>This class bridges the gap between the MCP protocol's tool representation
and the agent framework's tool interface, allowing MCP tools to be used
seamlessly within the agent framework.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/mcp/mcp_agent_tool.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPAgentTool</span><span class="p">(</span><span class="n">AgentTool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adapter class that wraps an MCP tool and exposes it as an AgentTool.</span>

<span class="sd">    This class bridges the gap between the MCP protocol&#39;s tool representation</span>
<span class="sd">    and the agent framework&#39;s tool interface, allowing MCP tools to be used</span>
<span class="sd">    seamlessly within the agent framework.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_tool</span><span class="p">:</span> <span class="n">MCPTool</span><span class="p">,</span> <span class="n">mcp_client</span><span class="p">:</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a new MCPAgentTool instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcp_tool: The MCP tool to adapt</span>
<span class="sd">            mcp_client: The MCP server connection to use for tool invocation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | creating mcp agent tool&quot;</span><span class="p">,</span> <span class="n">mcp_tool</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span> <span class="o">=</span> <span class="n">mcp_tool</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcp_client</span> <span class="o">=</span> <span class="n">mcp_client</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The name of the MCP tool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolSpec</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the specification of the tool.</span>

<span class="sd">        This method converts the MCP tool specification to the agent framework&#39;s</span>
<span class="sd">        ToolSpec format, including the input schema and description.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ToolSpec: The tool specification in the agent framework format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span><span class="o">.</span><span class="n">description</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;Tool which performs </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;inputSchema&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span><span class="o">.</span><span class="n">inputSchema</span><span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the type of the tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The type of the tool, always &quot;python&quot; for MCP tools</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;python&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Invoke the MCP tool.</span>

<span class="sd">        This method delegates the tool invocation to the MCP server connection,</span>
<span class="sd">        passing the tool use ID, tool name, and input arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;invoking MCP tool &#39;</span><span class="si">%s</span><span class="s2">&#39; with tool_use_id=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_client</span><span class="o">.</span><span class="n">call_tool_sync</span><span class="p">(</span>
            <span class="n">tool_use_id</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_name" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the name of the tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the MCP tool</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_spec</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_spec" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the specification of the tool.</p>
<p>This method converts the MCP tool specification to the agent framework's
ToolSpec format, including the input schema and description.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ToolSpec</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolSpec (strands.types.tools.ToolSpec)" href="../types/#strands.types.tools.ToolSpec">ToolSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tool specification in the agent framework format</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tool_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.tool_type" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the type of the tool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the tool, always "python" for MCP tools</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mcp_tool</span><span class="p">,</span> <span class="n">mcp_client</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Initialize a new MCPAgentTool instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mcp_tool</code>
            </td>
            <td>
                  <code><span title="mcp.types.Tool">Tool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP tool to adapt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mcp_client</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MCPClient (strands.tools.mcp.mcp_client.MCPClient)" href="#strands.tools.mcp.mcp_client.MCPClient">MCPClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP server connection to use for tool invocation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_agent_tool.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_tool</span><span class="p">:</span> <span class="n">MCPTool</span><span class="p">,</span> <span class="n">mcp_client</span><span class="p">:</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a new MCPAgentTool instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        mcp_tool: The MCP tool to adapt</span>
<span class="sd">        mcp_client: The MCP server connection to use for tool invocation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tool_name=&lt;</span><span class="si">%s</span><span class="s2">&gt; | creating mcp agent tool&quot;</span><span class="p">,</span> <span class="n">mcp_tool</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mcp_tool</span> <span class="o">=</span> <span class="n">mcp_tool</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mcp_client</span> <span class="o">=</span> <span class="n">mcp_client</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_agent_tool.MCPAgentTool.invoke" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invoke</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool.invoke" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Invoke the MCP tool.</p>
<p>This method delegates the tool invocation to the MCP server connection,
passing the tool use ID, tool name, and input arguments.</p>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_agent_tool.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">ToolUse</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Invoke the MCP tool.</span>

<span class="sd">    This method delegates the tool invocation to the MCP server connection,</span>
<span class="sd">    passing the tool use ID, tool name, and input arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;invoking MCP tool &#39;</span><span class="si">%s</span><span class="s2">&#39; with tool_use_id=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcp_client</span><span class="o">.</span><span class="n">call_tool_sync</span><span class="p">(</span>
        <span class="n">tool_use_id</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;toolUseId&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">tool</span><span class="p">[</span><span class="s2">&quot;input&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="strands.tools.mcp.mcp_client" class="doc doc-heading">
            <code>strands.tools.mcp.mcp_client</code>


<a href="#strands.tools.mcp.mcp_client" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Model Context Protocol (MCP) server connection management module.</p>
<p>This module provides the MCPClient class which handles connections to MCP servers.
It manages the lifecycle of MCP connections, including initialization, tool discovery,
tool invocation, and proper cleanup of resources. The connection runs in a background
thread to avoid blocking the main application thread while maintaining communication
with the MCP service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="strands.tools.mcp.mcp_client.MCPClient" class="doc doc-heading">
            <code>MCPClient</code>


<a href="#strands.tools.mcp.mcp_client.MCPClient" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


        <p>Represents a connection to a Model Context Protocol (MCP) server.</p>
<p>This class implements a context manager pattern for efficient connection management,
allowing reuse of the same connection for multiple tool calls to reduce latency.
It handles the creation, initialization, and cleanup of MCP connections.</p>
<p>The connection runs in a background thread to avoid blocking the main application thread
while maintaining communication with the MCP service.</p>







              <details class="quote">
                <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a connection to a Model Context Protocol (MCP) server.</span>

<span class="sd">    This class implements a context manager pattern for efficient connection management,</span>
<span class="sd">    allowing reuse of the same connection for multiple tool calls to reduce latency.</span>
<span class="sd">    It handles the creation, initialization, and cleanup of MCP connections.</span>

<span class="sd">    The connection runs in a background thread to avoid blocking the main application thread</span>
<span class="sd">    while maintaining communication with the MCP service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transport_callable</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">MCPTransport</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a new MCP Server connection.</span>

<span class="sd">        Args:</span>
<span class="sd">            transport_callable: A callable that returns an MCPTransport (read_stream, write_stream) tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;initializing MCPClient connection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="p">:</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>  <span class="c1"># Main thread blocks until future completes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>  <span class="c1"># Do not want to block other threads while close event is false</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transport_callable</span> <span class="o">=</span> <span class="n">transport_callable</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="p">:</span> <span class="n">ClientSession</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span><span class="p">:</span> <span class="n">AbstractEventLoop</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager entry point which initializes the MCP server connection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Context manager exit point that cleans up resources.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts the background thread and waits for initialization.</span>

<span class="sd">        This method starts the background thread that manages the MCP connection</span>
<span class="sd">        and blocks until the connection is ready or times out.</span>

<span class="sd">        Returns:</span>
<span class="sd">            self: The MCPClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If the MCP connection fails to initialize within the timeout period</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;the client session is currently running&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;entering MCPClient context&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_background_task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;background thread started, waiting for ready event&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Blocking main thread until session is initialized in other thread or if the thread stops</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;the client initialization was successful&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">futures</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;background thread did not start in 30 seconds&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;client failed to initialize&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;the client initialization failed&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span> <span class="n">exc_val</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Signals the background thread to stop and waits for it to complete, ensuring proper cleanup of all resources.</span>

<span class="sd">        Args:</span>
<span class="sd">            exc_type: Exception type if an exception was raised in the context</span>
<span class="sd">            exc_val: Exception value if an exception was raised in the context</span>
<span class="sd">            exc_tb: Exception traceback if an exception was raised in the context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;exiting MCPClient context&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_set_close_event</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_set_close_event</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;waiting for background thread to join&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;background thread joined, MCPClient context exited&quot;</span><span class="p">)</span>

        <span class="c1"># Reset fields to allow instance reuse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_tools_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MCPAgentTool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronously retrieves the list of available tools from the MCP server.</span>

<span class="sd">        This method calls the asynchronous list_tools method on the MCP session</span>
<span class="sd">        and adapts the returned tools to the AgentTool interface.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[AgentTool]: A list of available tools adapted to the AgentTool interface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;listing MCP tools synchronously&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="n">CLIENT_SESSION_NOT_RUNNING_ERROR_MESSAGE</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_list_tools_async</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ListToolsResult</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>

        <span class="n">list_tools_response</span><span class="p">:</span> <span class="n">ListToolsResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_list_tools_async</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;received </span><span class="si">%d</span><span class="s2"> tools from MCP server&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_tools_response</span><span class="o">.</span><span class="n">tools</span><span class="p">))</span>

        <span class="n">mcp_tools</span> <span class="o">=</span> <span class="p">[</span><span class="n">MCPAgentTool</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">list_tools_response</span><span class="o">.</span><span class="n">tools</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;successfully adapted </span><span class="si">%d</span><span class="s2"> MCP tools&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mcp_tools</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">mcp_tools</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">call_tool_sync</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tool_use_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">read_timeout_seconds</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronously calls a tool on the MCP server.</span>

<span class="sd">        This method calls the asynchronous call_tool method on the MCP session</span>
<span class="sd">        and converts the result to the ToolResult format.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_use_id: Unique identifier for this tool use</span>
<span class="sd">            name: Name of the tool to call</span>
<span class="sd">            arguments: Optional arguments to pass to the tool</span>
<span class="sd">            read_timeout_seconds: Optional timeout for the tool call</span>

<span class="sd">        Returns:</span>
<span class="sd">            ToolResult: The result of the tool call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;calling MCP tool &#39;</span><span class="si">%s</span><span class="s2">&#39; synchronously with tool_use_id=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tool_use_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="n">CLIENT_SESSION_NOT_RUNNING_ERROR_MESSAGE</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_call_tool_async</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MCPCallToolResult</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="o">.</span><span class="n">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">read_timeout_seconds</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">call_tool_result</span><span class="p">:</span> <span class="n">MCPCallToolResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_call_tool_async</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;received tool result with </span><span class="si">%d</span><span class="s2"> content items&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">call_tool_result</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>

            <span class="n">mapped_content</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">mapped_content</span>
                <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">call_tool_result</span><span class="o">.</span><span class="n">content</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">mapped_content</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_mcp_content_to_tool_result_content</span><span class="p">(</span><span class="n">content</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">]</span>

            <span class="n">status</span><span class="p">:</span> <span class="n">ToolResultStatus</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span> <span class="k">if</span> <span class="n">call_tool_result</span><span class="o">.</span><span class="n">isError</span> <span class="k">else</span> <span class="s2">&quot;success&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;tool execution completed with status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">toolUseId</span><span class="o">=</span><span class="n">tool_use_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">mapped_content</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool execution failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="n">toolUseId</span><span class="o">=</span><span class="n">tool_use_id</span><span class="p">,</span>
                <span class="n">content</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_background_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Asynchronous method that runs in the background thread to manage the MCP connection.</span>

<span class="sd">        This method establishes the transport connection, creates and initializes the MCP session,</span>
<span class="sd">        signals readiness to the main thread, and waits for a close signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;starting async background thread for MCP connection&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transport_callable</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;transport connection established&quot;</span><span class="p">)</span>
                <span class="k">async</span> <span class="k">with</span> <span class="n">ClientSession</span><span class="p">(</span><span class="n">read_stream</span><span class="p">,</span> <span class="n">write_stream</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;initializing MCP session&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;session initialized successfully&quot;</span><span class="p">)</span>
                    <span class="c1"># Store the session for use while we await the close event</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span> <span class="o">=</span> <span class="n">session</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Signal that the session has been created and is ready for use</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;waiting for close signal&quot;</span><span class="p">)</span>
                    <span class="c1"># Keep background thread running until signaled to close.</span>
                    <span class="c1"># Thread is not blocked as this is an asyncio.Event not a threading.Event</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;close signal received&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># If we encounter an exception and the future is still running,</span>
            <span class="c1"># it means it was encountered during the initialization phase.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="o">.</span><span class="n">set_exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span>
                    <span class="s2">&quot;encountered exception on background thread after initialization </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_background_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets up and runs the event loop in the background thread.</span>

<span class="sd">        This method creates a new event loop for the background thread,</span>
<span class="sd">        sets it as the current event loop, and runs the async_background_thread</span>
<span class="sd">        coroutine until completion. In this case &quot;until completion&quot; means until the _close_event is set.</span>
<span class="sd">        This allows for a long-running event loop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;setting up background task event loop&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_async_background_thread</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_map_mcp_content_to_tool_result_content</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">MCPTextContent</span> <span class="o">|</span> <span class="n">MCPImageContent</span> <span class="o">|</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ToolResultContent</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maps MCP content types to tool result content types.</span>

<span class="sd">        This method converts MCP-specific content types to the generic</span>
<span class="sd">        ToolResultContent format used by the agent framework.</span>

<span class="sd">        Args:</span>
<span class="sd">            content: The MCP content to convert</span>

<span class="sd">        Returns:</span>
<span class="sd">            ToolResultContent or None: The converted content, or None if the content type is not supported</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">MCPTextContent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;mapping MCP text content&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">content</span><span class="o">.</span><span class="n">text</span><span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">MCPImageContent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;mapping MCP image content with mime type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">.</span><span class="n">mimeType</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="n">MIME_TO_FORMAT</span><span class="p">[</span><span class="n">content</span><span class="o">.</span><span class="n">mimeType</span><span class="p">],</span>
                    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;bytes&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">data</span><span class="p">)},</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;unhandled content type: </span><span class="si">%s</span><span class="s2"> - dropping content&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_log_debug_with_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logger helper to help differentiate logs coming from MCPClient background thread.&quot;&quot;&quot;</span>
        <span class="n">formatted_msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">%</span> <span class="n">args</span> <span class="k">if</span> <span class="n">args</span> <span class="k">else</span> <span class="n">msg</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;[Thread: </span><span class="si">%s</span><span class="s2">, Session: </span><span class="si">%s</span><span class="s2">] </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span><span class="p">,</span> <span class="n">formatted_msg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_invoke_on_background_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coro</span><span class="p">:</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;the client session was not initialized&quot;</span><span class="p">)</span>

        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run_coroutine_threadsafe</span><span class="p">(</span><span class="n">coro</span><span class="o">=</span><span class="n">coro</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_session_active</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.__enter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.__enter__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Context manager entry point which initializes the MCP server connection.</p>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager entry point which initializes the MCP server connection.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.__exit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.__exit__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Context manager exit point that cleans up resources.</p>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="ne">BaseException</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">TracebackType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Context manager exit point that cleans up resources.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">transport_callable</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Initialize a new MCP Server connection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>transport_callable</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[], <span title="strands.tools.mcp.mcp_types.MCPTransport">MCPTransport</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A callable that returns an MCPTransport (read_stream, write_stream) tuple</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transport_callable</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">MCPTransport</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a new MCP Server connection.</span>

<span class="sd">    Args:</span>
<span class="sd">        transport_callable: A callable that returns an MCPTransport (read_stream, write_stream) tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;initializing MCPClient connection&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="p">:</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>  <span class="c1"># Main thread blocks until future completes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>  <span class="c1"># Do not want to block other threads while close event is false</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transport_callable</span> <span class="o">=</span> <span class="n">transport_callable</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="p">:</span> <span class="n">ClientSession</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_event_loop</span><span class="p">:</span> <span class="n">AbstractEventLoop</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.call_tool_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">call_tool_sync</span><span class="p">(</span><span class="n">tool_use_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">read_timeout_seconds</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.call_tool_sync" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Synchronously calls a tool on the MCP server.</p>
<p>This method calls the asynchronous call_tool method on the MCP session
and converts the result to the ToolResult format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_use_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique identifier for this tool use</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool to call</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>arguments</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional arguments to pass to the tool</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>read_timeout_seconds</code>
            </td>
            <td>
                  <code><span title="datetime.timedelta">timedelta</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional timeout for the tool call</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ToolResult</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="ToolResult (strands.types.tools.ToolResult)" href="../types/#strands.types.tools.ToolResult">ToolResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the tool call</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">call_tool_sync</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tool_use_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">read_timeout_seconds</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronously calls a tool on the MCP server.</span>

<span class="sd">    This method calls the asynchronous call_tool method on the MCP session</span>
<span class="sd">    and converts the result to the ToolResult format.</span>

<span class="sd">    Args:</span>
<span class="sd">        tool_use_id: Unique identifier for this tool use</span>
<span class="sd">        name: Name of the tool to call</span>
<span class="sd">        arguments: Optional arguments to pass to the tool</span>
<span class="sd">        read_timeout_seconds: Optional timeout for the tool call</span>

<span class="sd">    Returns:</span>
<span class="sd">        ToolResult: The result of the tool call</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;calling MCP tool &#39;</span><span class="si">%s</span><span class="s2">&#39; synchronously with tool_use_id=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tool_use_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="n">CLIENT_SESSION_NOT_RUNNING_ERROR_MESSAGE</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_call_tool_async</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MCPCallToolResult</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="o">.</span><span class="n">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">,</span> <span class="n">read_timeout_seconds</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">call_tool_result</span><span class="p">:</span> <span class="n">MCPCallToolResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_call_tool_async</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;received tool result with </span><span class="si">%d</span><span class="s2"> content items&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">call_tool_result</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>

        <span class="n">mapped_content</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">mapped_content</span>
            <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">call_tool_result</span><span class="o">.</span><span class="n">content</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mapped_content</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_mcp_content_to_tool_result_content</span><span class="p">(</span><span class="n">content</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">]</span>

        <span class="n">status</span><span class="p">:</span> <span class="n">ToolResultStatus</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span> <span class="k">if</span> <span class="n">call_tool_result</span><span class="o">.</span><span class="n">isError</span> <span class="k">else</span> <span class="s2">&quot;success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;tool execution completed with status: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">toolUseId</span><span class="o">=</span><span class="n">tool_use_id</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">mapped_content</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;tool execution failed: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ToolResult</span><span class="p">(</span>
            <span class="n">status</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
            <span class="n">toolUseId</span><span class="o">=</span><span class="n">tool_use_id</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Tool execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}],</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.list_tools_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_tools_sync</span><span class="p">()</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.list_tools_sync" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Synchronously retrieves the list of available tools from the MCP server.</p>
<p>This method calls the asynchronous list_tools method on the MCP session
and adapts the returned tools to the AgentTool interface.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="MCPAgentTool (strands.tools.mcp.mcp_agent_tool.MCPAgentTool)" href="#strands.tools.mcp.mcp_agent_tool.MCPAgentTool">MCPAgentTool</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[AgentTool]: A list of available tools adapted to the AgentTool interface</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_tools_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">MCPAgentTool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronously retrieves the list of available tools from the MCP server.</span>

<span class="sd">    This method calls the asynchronous list_tools method on the MCP session</span>
<span class="sd">    and adapts the returned tools to the AgentTool interface.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[AgentTool]: A list of available tools adapted to the AgentTool interface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;listing MCP tools synchronously&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="n">CLIENT_SESSION_NOT_RUNNING_ERROR_MESSAGE</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_list_tools_async</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ListToolsResult</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread_session</span><span class="o">.</span><span class="n">list_tools</span><span class="p">()</span>

    <span class="n">list_tools_response</span><span class="p">:</span> <span class="n">ListToolsResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_list_tools_async</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;received </span><span class="si">%d</span><span class="s2"> tools from MCP server&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_tools_response</span><span class="o">.</span><span class="n">tools</span><span class="p">))</span>

    <span class="n">mcp_tools</span> <span class="o">=</span> <span class="p">[</span><span class="n">MCPAgentTool</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">list_tools_response</span><span class="o">.</span><span class="n">tools</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;successfully adapted </span><span class="si">%d</span><span class="s2"> MCP tools&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mcp_tools</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mcp_tools</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.start" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Starts the background thread and waits for initialization.</p>
<p>This method starts the background thread that manages the MCP connection
and blocks until the connection is ready or times out.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="MCPClient (strands.tools.mcp.mcp_client.MCPClient)" href="#strands.tools.mcp.mcp_client.MCPClient">MCPClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCPClient instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the MCP connection fails to initialize within the timeout period</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;MCPClient&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Starts the background thread and waits for initialization.</span>

<span class="sd">    This method starts the background thread that manages the MCP connection</span>
<span class="sd">    and blocks until the connection is ready or times out.</span>

<span class="sd">    Returns:</span>
<span class="sd">        self: The MCPClient instance</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the MCP connection fails to initialize within the timeout period</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_session_active</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;the client session is currently running&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;entering MCPClient context&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_background_task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;background thread started, waiting for ready event&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Blocking main thread until session is initialized in other thread or if the thread stops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;the client initialization was successful&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">futures</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;background thread did not start in 30 seconds&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;client failed to initialize&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">MCPClientInitializationError</span><span class="p">(</span><span class="s2">&quot;the client initialization failed&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="strands.tools.mcp.mcp_client.MCPClient.stop" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span></code>

<a href="#strands.tools.mcp.mcp_client.MCPClient.stop" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Signals the background thread to stop and waits for it to complete, ensuring proper cleanup of all resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exc_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="BaseException">BaseException</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exception type if an exception was raised in the context</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exc_val</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="BaseException">BaseException</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exception value if an exception was raised in the context</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exc_tb</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="types.TracebackType">TracebackType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exception traceback if an exception was raised in the context</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>strands/tools/mcp/mcp_client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span> <span class="n">exc_val</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Signals the background thread to stop and waits for it to complete, ensuring proper cleanup of all resources.</span>

<span class="sd">    Args:</span>
<span class="sd">        exc_type: Exception type if an exception was raised in the context</span>
<span class="sd">        exc_val: Exception value if an exception was raised in the context</span>
<span class="sd">        exc_tb: Exception traceback if an exception was raised in the context</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;exiting MCPClient context&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_set_close_event</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_invoke_on_background_thread</span><span class="p">(</span><span class="n">_set_close_event</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;waiting for background thread to join&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_log_debug_with_thread</span><span class="p">(</span><span class="s2">&quot;background thread joined, MCPClient context exited&quot;</span><span class="p">)</span>

    <span class="c1"># Reset fields to allow instance reuse</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_init_future</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_close_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background_thread</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="strands.tools.mcp.mcp_types" class="doc doc-heading">
            <code>strands.tools.mcp.mcp_types</code>


<a href="#strands.tools.mcp.mcp_types" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Type definitions for MCP integration.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>